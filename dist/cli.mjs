#!/usr/bin/env node
import Bt from"tty";import{Buffer as Dn}from"node:buffer";import N from"node:path";import $t from"node:child_process";import y,{stdin as vt,stdout as At}from"node:process";import sn,{execSync as an}from"child_process";import L from"path";import $e,{writeFileSync as cn}from"fs";import ln from"node:url";import fn,{constants as xt}from"node:os";import St from"assert";import Ot from"events";import pn from"buffer";import ve from"stream";import dn from"util";import*as re from"node:readline";import Pt from"node:readline";import{WriteStream as mn}from"node:tty";import x from"fs/promises";import hn from"os";import Fn from"https";import Cn from"net";import gn from"tls";import En,{fileURLToPath as yn,pathToFileURL as bn}from"url";import oe from"debug";const wn="known-flag",Bn="unknown-flag",$n="argument",{stringify:V}=JSON,vn=/\B([A-Z])/g,An=e=>e.replace(vn,"-$1").toLowerCase(),{hasOwnProperty:xn}=Object.prototype,Y=(e,t)=>xn.call(e,t),Sn=e=>Array.isArray(e),Tt=e=>typeof e=="function"?[e,!1]:Sn(e)?[e[0],!0]:Tt(e.type),On=(e,t)=>e===Boolean?t!=="false":t,Pn=(e,t)=>typeof t=="boolean"?t:e===Number&&t===""?Number.NaN:e(t),Tn=/[\s.:=]/,In=e=>{const t=`Flag name ${V(e)}`;if(e.length===0)throw new Error(`${t} cannot be empty`);if(e.length===1)throw new Error(`${t} must be longer than a character`);const u=e.match(Tn);if(u)throw new Error(`${t} cannot contain ${V(u?.[0])}`)},_n=e=>{const t={},u=(n,r)=>{if(Y(t,n))throw new Error(`Duplicate flags named ${V(n)}`);t[n]=r};for(const n in e){if(!Y(e,n))continue;In(n);const r=e[n],o=[[],...Tt(r),r];u(n,o);const D=An(n);if(n!==D&&u(D,o),"alias"in r&&typeof r.alias=="string"){const{alias:i}=r,s=`Flag alias ${V(i)} for flag ${V(n)}`;if(i.length===0)throw new Error(`${s} cannot be empty`);if(i.length>1)throw new Error(`${s} must be a single character`);u(i,o)}}return t},kn=(e,t)=>{const u={};for(const n in e){if(!Y(e,n))continue;const[r,,o,D]=t[n];if(r.length===0&&"default"in D){let{default:i}=D;typeof i=="function"&&(i=i()),u[n]=i}else u[n]=o?r:r.pop()}return u},De="--",Rn=/[.:=]/,jn=/^-{1,2}\w/,Mn=e=>{if(!jn.test(e))return;const t=!e.startsWith(De);let u=e.slice(t?1:2),n;const r=u.match(Rn);if(r){const{index:o}=r;n=u.slice(o+1),u=u.slice(0,o)}return[u,n,t]},Nn=(e,{onFlag:t,onArgument:u})=>{let n;const r=(o,D)=>{if(typeof n!="function")return!0;n(o,D),n=void 0};for(let o=0;o<e.length;o+=1){const D=e[o];if(D===De){r();const s=e.slice(o+1);u?.(s,[o],!0);break}const i=Mn(D);if(i){if(r(),!t)continue;const[s,a,l]=i;if(l)for(let c=0;c<s.length;c+=1){r();const f=c===s.length-1;n=t(s[c],f?a:void 0,[o,c+1,f])}else n=t(s,a,[o])}else r(D,[o])&&u?.([D],[o])}r()},Ln=(e,t)=>{for(const[u,n,r]of t.reverse()){if(n){const o=e[u];let D=o.slice(0,n);if(r||(D+=o.slice(n+1)),D!=="-"){e[u]=D;continue}}e.splice(u,1)}},Gn=(e,t=process.argv.slice(2),{ignore:u}={})=>{const n=[],r=_n(e),o={},D=[];return D[De]=[],Nn(t,{onFlag(i,s,a){const l=Y(r,i);if(!u?.(l?wn:Bn,i,s)){if(l){const[c,f]=r[i],p=On(f,s),d=(h,F)=>{n.push(a),F&&n.push(F),c.push(Pn(f,h||""))};return p===void 0?d:d(p)}Y(o,i)||(o[i]=[]),o[i].push(s===void 0?!0:s),n.push(a)}},onArgument(i,s,a){u?.($n,t[s[0]])||(D.push(...i),a?(D[De]=i,t.splice(s[0])):n.push(s))}}),Ln(t,n),{flags:kn(e,r),unknownFlags:o,_:D}};var Un=Object.create,ie=Object.defineProperty,Wn=Object.defineProperties,Hn=Object.getOwnPropertyDescriptor,Kn=Object.getOwnPropertyDescriptors,qn=Object.getOwnPropertyNames,It=Object.getOwnPropertySymbols,zn=Object.getPrototypeOf,_t=Object.prototype.hasOwnProperty,Vn=Object.prototype.propertyIsEnumerable,kt=(e,t,u)=>t in e?ie(e,t,{enumerable:!0,configurable:!0,writable:!0,value:u}):e[t]=u,se=(e,t)=>{for(var u in t||(t={}))_t.call(t,u)&&kt(e,u,t[u]);if(It)for(var u of It(t))Vn.call(t,u)&&kt(e,u,t[u]);return e},Ae=(e,t)=>Wn(e,Kn(t)),Yn=e=>ie(e,"__esModule",{value:!0}),Jn=(e,t)=>()=>(e&&(t=e(e=0)),t),Xn=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Zn=(e,t,u,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of qn(t))!_t.call(e,r)&&(u||r!=="default")&&ie(e,r,{get:()=>t[r],enumerable:!(n=Hn(t,r))||n.enumerable});return e},Qn=(e,t)=>Zn(Yn(ie(e!=null?Un(zn(e)):{},"default",!t&&e&&e.__esModule?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e),$=Jn(()=>{}),er=Xn((e,t)=>{$(),t.exports=function(){return/\uD83C\uDFF4\uDB40\uDC67\uDB40\uDC62(?:\uDB40\uDC77\uDB40\uDC6C\uDB40\uDC73|\uDB40\uDC73\uDB40\uDC63\uDB40\uDC74|\uDB40\uDC65\uDB40\uDC6E\uDB40\uDC67)\uDB40\uDC7F|(?:\uD83E\uDDD1\uD83C\uDFFF\u200D\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1|\uD83D\uDC69\uD83C\uDFFF\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69]))(?:\uD83C[\uDFFB-\uDFFE])|(?:\uD83E\uDDD1\uD83C\uDFFE\u200D\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1|\uD83D\uDC69\uD83C\uDFFE\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69]))(?:\uD83C[\uDFFB-\uDFFD\uDFFF])|(?:\uD83E\uDDD1\uD83C\uDFFD\u200D\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1|\uD83D\uDC69\uD83C\uDFFD\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69]))(?:\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])|(?:\uD83E\uDDD1\uD83C\uDFFC\u200D\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1|\uD83D\uDC69\uD83C\uDFFC\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69]))(?:\uD83C[\uDFFB\uDFFD-\uDFFF])|(?:\uD83E\uDDD1\uD83C\uDFFB\u200D\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1|\uD83D\uDC69\uD83C\uDFFB\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69]))(?:\uD83C[\uDFFC-\uDFFF])|\uD83D\uDC68(?:\uD83C\uDFFB(?:\u200D(?:\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFF]))|\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFC-\uDFFF])|[\u2695\u2696\u2708]\uFE0F|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD]))?|(?:\uD83C[\uDFFC-\uDFFF])\u200D\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFF]))|\u200D(?:\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D)?\uD83D\uDC68|(?:\uD83D[\uDC68\uDC69])\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67]))|\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67])|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFF\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFE])|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFE\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFD\uDFFF])|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFD\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFC\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB\uDFFD-\uDFFF])|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|(?:\uD83C\uDFFF\u200D[\u2695\u2696\u2708]|\uD83C\uDFFE\u200D[\u2695\u2696\u2708]|\uD83C\uDFFD\u200D[\u2695\u2696\u2708]|\uD83C\uDFFC\u200D[\u2695\u2696\u2708]|\u200D[\u2695\u2696\u2708])\uFE0F|\u200D(?:(?:\uD83D[\uDC68\uDC69])\u200D(?:\uD83D[\uDC66\uDC67])|\uD83D[\uDC66\uDC67])|\uD83C\uDFFF|\uD83C\uDFFE|\uD83C\uDFFD|\uD83C\uDFFC)?|(?:\uD83D\uDC69(?:\uD83C\uDFFB\u200D\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D(?:\uD83D[\uDC68\uDC69])|\uD83D[\uDC68\uDC69])|(?:\uD83C[\uDFFC-\uDFFF])\u200D\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D(?:\uD83D[\uDC68\uDC69])|\uD83D[\uDC68\uDC69]))|\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1)(?:\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC69\u200D\uD83D\uDC69\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67]))|\uD83D\uDC69(?:\u200D(?:\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D(?:\uD83D[\uDC68\uDC69])|\uD83D[\uDC68\uDC69])|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFF\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFE\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFD\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFC\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFB\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD]))|\uD83E\uDDD1(?:\u200D(?:\uD83E\uDD1D\u200D\uD83E\uDDD1|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFF\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFE\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFD\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFC\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFB\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD]))|\uD83D\uDC69\u200D\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC69\u200D\uD83D\uDC69\u200D(?:\uD83D[\uDC66\uDC67])|\uD83D\uDC69\u200D\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67])|(?:\uD83D\uDC41\uFE0F\u200D\uD83D\uDDE8|\uD83E\uDDD1(?:\uD83C\uDFFF\u200D[\u2695\u2696\u2708]|\uD83C\uDFFE\u200D[\u2695\u2696\u2708]|\uD83C\uDFFD\u200D[\u2695\u2696\u2708]|\uD83C\uDFFC\u200D[\u2695\u2696\u2708]|\uD83C\uDFFB\u200D[\u2695\u2696\u2708]|\u200D[\u2695\u2696\u2708])|\uD83D\uDC69(?:\uD83C\uDFFF\u200D[\u2695\u2696\u2708]|\uD83C\uDFFE\u200D[\u2695\u2696\u2708]|\uD83C\uDFFD\u200D[\u2695\u2696\u2708]|\uD83C\uDFFC\u200D[\u2695\u2696\u2708]|\uD83C\uDFFB\u200D[\u2695\u2696\u2708]|\u200D[\u2695\u2696\u2708])|\uD83D\uDE36\u200D\uD83C\uDF2B|\uD83C\uDFF3\uFE0F\u200D\u26A7|\uD83D\uDC3B\u200D\u2744|(?:(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD4\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC6F|\uD83E[\uDD3C\uDDDE\uDDDF])\u200D[\u2640\u2642]|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]|\uD83C\uDFF4\u200D\u2620|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD4\uDDD6-\uDDDD])\u200D[\u2640\u2642]|[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u2328\u23CF\u23ED-\u23EF\u23F1\u23F2\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB\u25FC\u2600-\u2604\u260E\u2611\u2618\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u2692\u2694-\u2697\u2699\u269B\u269C\u26A0\u26A7\u26B0\u26B1\u26C8\u26CF\u26D1\u26D3\u26E9\u26F0\u26F1\u26F4\u26F7\u26F8\u2702\u2708\u2709\u270F\u2712\u2714\u2716\u271D\u2721\u2733\u2734\u2744\u2747\u2763\u27A1\u2934\u2935\u2B05-\u2B07\u3030\u303D\u3297\u3299]|\uD83C[\uDD70\uDD71\uDD7E\uDD7F\uDE02\uDE37\uDF21\uDF24-\uDF2C\uDF36\uDF7D\uDF96\uDF97\uDF99-\uDF9B\uDF9E\uDF9F\uDFCD\uDFCE\uDFD4-\uDFDF\uDFF5\uDFF7]|\uD83D[\uDC3F\uDCFD\uDD49\uDD4A\uDD6F\uDD70\uDD73\uDD76-\uDD79\uDD87\uDD8A-\uDD8D\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA\uDECB\uDECD-\uDECF\uDEE0-\uDEE5\uDEE9\uDEF0\uDEF3])\uFE0F|\uD83C\uDFF3\uFE0F\u200D\uD83C\uDF08|\uD83D\uDC69\u200D\uD83D\uDC67|\uD83D\uDC69\u200D\uD83D\uDC66|\uD83D\uDE35\u200D\uD83D\uDCAB|\uD83D\uDE2E\u200D\uD83D\uDCA8|\uD83D\uDC15\u200D\uD83E\uDDBA|\uD83E\uDDD1(?:\uD83C\uDFFF|\uD83C\uDFFE|\uD83C\uDFFD|\uD83C\uDFFC|\uD83C\uDFFB)?|\uD83D\uDC69(?:\uD83C\uDFFF|\uD83C\uDFFE|\uD83C\uDFFD|\uD83C\uDFFC|\uD83C\uDFFB)?|\uD83C\uDDFD\uD83C\uDDF0|\uD83C\uDDF6\uD83C\uDDE6|\uD83C\uDDF4\uD83C\uDDF2|\uD83D\uDC08\u200D\u2B1B|\u2764\uFE0F\u200D(?:\uD83D\uDD25|\uD83E\uDE79)|\uD83D\uDC41\uFE0F|\uD83C\uDFF3\uFE0F|\uD83C\uDDFF(?:\uD83C[\uDDE6\uDDF2\uDDFC])|\uD83C\uDDFE(?:\uD83C[\uDDEA\uDDF9])|\uD83C\uDDFC(?:\uD83C[\uDDEB\uDDF8])|\uD83C\uDDFB(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA])|\uD83C\uDDFA(?:\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF])|\uD83C\uDDF9(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF])|\uD83C\uDDF8(?:\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF])|\uD83C\uDDF7(?:\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC])|\uD83C\uDDF5(?:\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE])|\uD83C\uDDF3(?:\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF])|\uD83C\uDDF2(?:\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF])|\uD83C\uDDF1(?:\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE])|\uD83C\uDDF0(?:\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF])|\uD83C\uDDEF(?:\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5])|\uD83C\uDDEE(?:\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9])|\uD83C\uDDED(?:\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA])|\uD83C\uDDEC(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE])|\uD83C\uDDEB(?:\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7])|\uD83C\uDDEA(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA])|\uD83C\uDDE9(?:\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF])|\uD83C\uDDE8(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF])|\uD83C\uDDE7(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF])|\uD83C\uDDE6(?:\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF])|[#\*0-9]\uFE0F\u20E3|\u2764\uFE0F|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD4\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])|\uD83C\uDFF4|(?:[\u270A\u270B]|\uD83C[\uDF85\uDFC2\uDFC7]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC6B-\uDC6D\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDC8F\uDC91\uDCAA\uDD7A\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC]|\uD83E[\uDD0C\uDD0F\uDD18-\uDD1C\uDD1E\uDD1F\uDD30-\uDD34\uDD36\uDD77\uDDB5\uDDB6\uDDBB\uDDD2\uDDD3\uDDD5])(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u261D\u270C\u270D]|\uD83D[\uDD74\uDD90])(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])|[\u270A\u270B]|\uD83C[\uDF85\uDFC2\uDFC7]|\uD83D[\uDC08\uDC15\uDC3B\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC6B-\uDC6D\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDC8F\uDC91\uDCAA\uDD7A\uDD95\uDD96\uDE2E\uDE35\uDE36\uDE4C\uDE4F\uDEC0\uDECC]|\uD83E[\uDD0C\uDD0F\uDD18-\uDD1C\uDD1E\uDD1F\uDD30-\uDD34\uDD36\uDD77\uDDB5\uDDB6\uDDBB\uDDD2\uDDD3\uDDD5]|\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD4\uDDD6-\uDDDD]|\uD83D\uDC6F|\uD83E[\uDD3C\uDDDE\uDDDF]|[\u231A\u231B\u23E9-\u23EC\u23F0\u23F3\u25FD\u25FE\u2614\u2615\u2648-\u2653\u267F\u2693\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\u26FA\u26FD\u2705\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u27B0\u27BF\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD8E\uDD91-\uDD9A\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF84\uDF86-\uDF93\uDFA0-\uDFC1\uDFC5\uDFC6\uDFC8\uDFC9\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF8-\uDFFF]|\uD83D[\uDC00-\uDC07\uDC09-\uDC14\uDC16-\uDC3A\uDC3C-\uDC3E\uDC40\uDC44\uDC45\uDC51-\uDC65\uDC6A\uDC79-\uDC7B\uDC7D-\uDC80\uDC84\uDC88-\uDC8E\uDC90\uDC92-\uDCA9\uDCAB-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDDA4\uDDFB-\uDE2D\uDE2F-\uDE34\uDE37-\uDE44\uDE48-\uDE4A\uDE80-\uDEA2\uDEA4-\uDEB3\uDEB7-\uDEBF\uDEC1-\uDEC5\uDED0-\uDED2\uDED5-\uDED7\uDEEB\uDEEC\uDEF4-\uDEFC\uDFE0-\uDFEB]|\uD83E[\uDD0D\uDD0E\uDD10-\uDD17\uDD1D\uDD20-\uDD25\uDD27-\uDD2F\uDD3A\uDD3F-\uDD45\uDD47-\uDD76\uDD78\uDD7A-\uDDB4\uDDB7\uDDBA\uDDBC-\uDDCB\uDDD0\uDDE0-\uDDFF\uDE70-\uDE74\uDE78-\uDE7A\uDE80-\uDE86\uDE90-\uDEA8\uDEB0-\uDEB6\uDEC0-\uDEC2\uDED0-\uDED6]|(?:[\u231A\u231B\u23E9-\u23EC\u23F0\u23F3\u25FD\u25FE\u2614\u2615\u2648-\u2653\u267F\u2693\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\u26FA\u26FD\u2705\u270A\u270B\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u27B0\u27BF\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF93\uDFA0-\uDFCA\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF4\uDFF8-\uDFFF]|\uD83D[\uDC00-\uDC3E\uDC40\uDC42-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDD7A\uDD95\uDD96\uDDA4\uDDFB-\uDE4F\uDE80-\uDEC5\uDECC\uDED0-\uDED2\uDED5-\uDED7\uDEEB\uDEEC\uDEF4-\uDEFC\uDFE0-\uDFEB]|\uD83E[\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDD78\uDD7A-\uDDCB\uDDCD-\uDDFF\uDE70-\uDE74\uDE78-\uDE7A\uDE80-\uDE86\uDE90-\uDEA8\uDEB0-\uDEB6\uDEC0-\uDEC2\uDED0-\uDED6])|(?:[#\*0-9\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26A7\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDED5-\uDED7\uDEE0-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEFC\uDFE0-\uDFEB]|\uD83E[\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDD78\uDD7A-\uDDCB\uDDCD-\uDDFF\uDE70-\uDE74\uDE78-\uDE7A\uDE80-\uDE86\uDE90-\uDEA8\uDEB0-\uDEB6\uDEC0-\uDEC2\uDED0-\uDED6])\uFE0F|(?:[\u261D\u26F9\u270A-\u270D]|\uD83C[\uDF85\uDFC2-\uDFC4\uDFC7\uDFCA-\uDFCC]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66-\uDC78\uDC7C\uDC81-\uDC83\uDC85-\uDC87\uDC8F\uDC91\uDCAA\uDD74\uDD75\uDD7A\uDD90\uDD95\uDD96\uDE45-\uDE47\uDE4B-\uDE4F\uDEA3\uDEB4-\uDEB6\uDEC0\uDECC]|\uD83E[\uDD0C\uDD0F\uDD18-\uDD1F\uDD26\uDD30-\uDD39\uDD3C-\uDD3E\uDD77\uDDB5\uDDB6\uDDB8\uDDB9\uDDBB\uDDCD-\uDDCF\uDDD1-\uDDDD])/g}});$(),$(),$();var tr=e=>{var t,u,n;let r=(t=process.stdout.columns)!=null?t:Number.POSITIVE_INFINITY;return typeof e=="function"&&(e=e(r)),e||(e={}),Array.isArray(e)?{columns:e,stdoutColumns:r}:{columns:(u=e.columns)!=null?u:[],stdoutColumns:(n=e.stdoutColumns)!=null?n:r}};$(),$(),$(),$(),$();function ur({onlyFirst:e=!1}={}){let t=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|");return new RegExp(t,e?void 0:"g")}function Rt(e){if(typeof e!="string")throw new TypeError(`Expected a \`string\`, got \`${typeof e}\``);return e.replace(ur(),"")}$();function nr(e){return Number.isInteger(e)?e>=4352&&(e<=4447||e===9001||e===9002||11904<=e&&e<=12871&&e!==12351||12880<=e&&e<=19903||19968<=e&&e<=42182||43360<=e&&e<=43388||44032<=e&&e<=55203||63744<=e&&e<=64255||65040<=e&&e<=65049||65072<=e&&e<=65131||65281<=e&&e<=65376||65504<=e&&e<=65510||110592<=e&&e<=110593||127488<=e&&e<=127569||131072<=e&&e<=262141):!1}var rr=Qn(er(),1);function _(e){if(typeof e!="string"||e.length===0||(e=Rt(e),e.length===0))return 0;e=e.replace((0,rr.default)(),"  ");let t=0;for(let u=0;u<e.length;u++){let n=e.codePointAt(u);n<=31||n>=127&&n<=159||n>=768&&n<=879||(n>65535&&u++,t+=nr(n)?2:1)}return t}var jt=e=>Math.max(...e.split(`
`).map(_)),or=e=>{let t=[];for(let u of e){let{length:n}=u,r=n-t.length;for(let o=0;o<r;o+=1)t.push(0);for(let o=0;o<n;o+=1){let D=jt(u[o]);D>t[o]&&(t[o]=D)}}return t};$();var Mt=/^\d+%$/,Nt={width:"auto",align:"left",contentWidth:0,paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0,horizontalPadding:0,paddingLeftString:"",paddingRightString:""},Dr=(e,t)=>{var u;let n=[];for(let r=0;r<e.length;r+=1){let o=(u=t[r])!=null?u:"auto";if(typeof o=="number"||o==="auto"||o==="content-width"||typeof o=="string"&&Mt.test(o)){n.push(Ae(se({},Nt),{width:o,contentWidth:e[r]}));continue}if(o&&typeof o=="object"){let D=Ae(se(se({},Nt),o),{contentWidth:e[r]});D.horizontalPadding=D.paddingLeft+D.paddingRight,n.push(D);continue}throw new Error(`Invalid column width: ${JSON.stringify(o)}`)}return n};function ir(e,t){for(let u of e){let{width:n}=u;if(n==="content-width"&&(u.width=u.contentWidth),n==="auto"){let s=Math.min(20,u.contentWidth);u.width=s,u.autoOverflow=u.contentWidth-s}if(typeof n=="string"&&Mt.test(n)){let s=Number.parseFloat(n.slice(0,-1))/100;u.width=Math.floor(t*s)-(u.paddingLeft+u.paddingRight)}let{horizontalPadding:r}=u,o=1,D=o+r;if(D>=t){let s=D-t,a=Math.ceil(u.paddingLeft/r*s),l=s-a;u.paddingLeft-=a,u.paddingRight-=l,u.horizontalPadding=u.paddingLeft+u.paddingRight}u.paddingLeftString=u.paddingLeft?" ".repeat(u.paddingLeft):"",u.paddingRightString=u.paddingRight?" ".repeat(u.paddingRight):"";let i=t-u.horizontalPadding;u.width=Math.max(Math.min(u.width,i),o)}}var Lt=()=>Object.assign([],{columns:0});function sr(e,t){let u=[Lt()],[n]=u;for(let r of e){let o=r.width+r.horizontalPadding;n.columns+o>t&&(n=Lt(),u.push(n)),n.push(r),n.columns+=o}for(let r of u){let o=r.reduce((f,p)=>f+p.width+p.horizontalPadding,0),D=t-o;if(D===0)continue;let i=r.filter(f=>"autoOverflow"in f),s=i.filter(f=>f.autoOverflow>0),a=s.reduce((f,p)=>f+p.autoOverflow,0),l=Math.min(a,D);for(let f of s){let p=Math.floor(f.autoOverflow/a*l);f.width+=p,D-=p}let c=Math.floor(D/i.length);for(let f=0;f<i.length;f+=1){let p=i[f];f===i.length-1?p.width+=D:p.width+=c,D-=c}}return u}function ar(e,t,u){let n=Dr(u,t);return ir(n,e),sr(n,e)}$(),$(),$();var xe=10,Gt=(e=0)=>t=>`\x1B[${t+e}m`,Ut=(e=0)=>t=>`\x1B[${38+e};5;${t}m`,Wt=(e=0)=>(t,u,n)=>`\x1B[${38+e};2;${t};${u};${n}m`;function cr(){let e=new Map,t={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};t.color.gray=t.color.blackBright,t.bgColor.bgGray=t.bgColor.bgBlackBright,t.color.grey=t.color.blackBright,t.bgColor.bgGrey=t.bgColor.bgBlackBright;for(let[u,n]of Object.entries(t)){for(let[r,o]of Object.entries(n))t[r]={open:`\x1B[${o[0]}m`,close:`\x1B[${o[1]}m`},n[r]=t[r],e.set(o[0],o[1]);Object.defineProperty(t,u,{value:n,enumerable:!1})}return Object.defineProperty(t,"codes",{value:e,enumerable:!1}),t.color.close="\x1B[39m",t.bgColor.close="\x1B[49m",t.color.ansi=Gt(),t.color.ansi256=Ut(),t.color.ansi16m=Wt(),t.bgColor.ansi=Gt(xe),t.bgColor.ansi256=Ut(xe),t.bgColor.ansi16m=Wt(xe),Object.defineProperties(t,{rgbToAnsi256:{value:(u,n,r)=>u===n&&n===r?u<8?16:u>248?231:Math.round((u-8)/247*24)+232:16+36*Math.round(u/255*5)+6*Math.round(n/255*5)+Math.round(r/255*5),enumerable:!1},hexToRgb:{value:u=>{let n=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(u.toString(16));if(!n)return[0,0,0];let{colorString:r}=n.groups;r.length===3&&(r=r.split("").map(D=>D+D).join(""));let o=Number.parseInt(r,16);return[o>>16&255,o>>8&255,o&255]},enumerable:!1},hexToAnsi256:{value:u=>t.rgbToAnsi256(...t.hexToRgb(u)),enumerable:!1},ansi256ToAnsi:{value:u=>{if(u<8)return 30+u;if(u<16)return 90+(u-8);let n,r,o;if(u>=232)n=((u-232)*10+8)/255,r=n,o=n;else{u-=16;let s=u%36;n=Math.floor(u/36)/5,r=Math.floor(s/6)/5,o=s%6/5}let D=Math.max(n,r,o)*2;if(D===0)return 30;let i=30+(Math.round(o)<<2|Math.round(r)<<1|Math.round(n));return D===2&&(i+=60),i},enumerable:!1},rgbToAnsi:{value:(u,n,r)=>t.ansi256ToAnsi(t.rgbToAnsi256(u,n,r)),enumerable:!1},hexToAnsi:{value:u=>t.ansi256ToAnsi(t.hexToAnsi256(u)),enumerable:!1}}),t}var lr=cr(),fr=lr,ae=new Set(["\x1B","\x9B"]),pr=39,Se="\x07",Ht="[",dr="]",Kt="m",Oe=`${dr}8;;`,qt=e=>`${ae.values().next().value}${Ht}${e}${Kt}`,zt=e=>`${ae.values().next().value}${Oe}${e}${Se}`,mr=e=>e.split(" ").map(t=>_(t)),Pe=(e,t,u)=>{let n=[...t],r=!1,o=!1,D=_(Rt(e[e.length-1]));for(let[i,s]of n.entries()){let a=_(s);if(D+a<=u?e[e.length-1]+=s:(e.push(s),D=0),ae.has(s)&&(r=!0,o=n.slice(i+1).join("").startsWith(Oe)),r){o?s===Se&&(r=!1,o=!1):s===Kt&&(r=!1);continue}D+=a,D===u&&i<n.length-1&&(e.push(""),D=0)}!D&&e[e.length-1].length>0&&e.length>1&&(e[e.length-2]+=e.pop())},hr=e=>{let t=e.split(" "),u=t.length;for(;u>0&&!(_(t[u-1])>0);)u--;return u===t.length?e:t.slice(0,u).join(" ")+t.slice(u).join("")},Fr=(e,t,u={})=>{if(u.trim!==!1&&e.trim()==="")return"";let n="",r,o,D=mr(e),i=[""];for(let[a,l]of e.split(" ").entries()){u.trim!==!1&&(i[i.length-1]=i[i.length-1].trimStart());let c=_(i[i.length-1]);if(a!==0&&(c>=t&&(u.wordWrap===!1||u.trim===!1)&&(i.push(""),c=0),(c>0||u.trim===!1)&&(i[i.length-1]+=" ",c++)),u.hard&&D[a]>t){let f=t-c,p=1+Math.floor((D[a]-f-1)/t);Math.floor((D[a]-1)/t)<p&&i.push(""),Pe(i,l,t);continue}if(c+D[a]>t&&c>0&&D[a]>0){if(u.wordWrap===!1&&c<t){Pe(i,l,t);continue}i.push("")}if(c+D[a]>t&&u.wordWrap===!1){Pe(i,l,t);continue}i[i.length-1]+=l}u.trim!==!1&&(i=i.map(a=>hr(a)));let s=[...i.join(`
`)];for(let[a,l]of s.entries()){if(n+=l,ae.has(l)){let{groups:f}=new RegExp(`(?:\\${Ht}(?<code>\\d+)m|\\${Oe}(?<uri>.*)${Se})`).exec(s.slice(a).join(""))||{groups:{}};if(f.code!==void 0){let p=Number.parseFloat(f.code);r=p===pr?void 0:p}else f.uri!==void 0&&(o=f.uri.length===0?void 0:f.uri)}let c=fr.codes.get(Number(r));s[a+1]===`
`?(o&&(n+=zt("")),r&&c&&(n+=qt(c))):l===`
`&&(r&&c&&(n+=qt(r)),o&&(n+=zt(o)))}return n};function Cr(e,t,u){return String(e).normalize().replace(/\r\n/g,`
`).split(`
`).map(n=>Fr(n,t,u)).join(`
`)}var Vt=e=>Array.from({length:e}).fill("");function gr(e,t){let u=[],n=0;for(let r of e){let o=0,D=r.map(s=>{var a;let l=(a=t[n])!=null?a:"";n+=1,s.preprocess&&(l=s.preprocess(l)),jt(l)>s.width&&(l=Cr(l,s.width,{hard:!0}));let c=l.split(`
`);if(s.postprocess){let{postprocess:f}=s;c=c.map((p,d)=>f.call(s,p,d))}return s.paddingTop&&c.unshift(...Vt(s.paddingTop)),s.paddingBottom&&c.push(...Vt(s.paddingBottom)),c.length>o&&(o=c.length),Ae(se({},s),{lines:c})}),i=[];for(let s=0;s<o;s+=1){let a=D.map(l=>{var c;let f=(c=l.lines[s])!=null?c:"",p=Number.isFinite(l.width)?" ".repeat(l.width-_(f)):"",d=l.paddingLeftString;return l.align==="right"&&(d+=p),d+=f,l.align==="left"&&(d+=p),d+l.paddingRightString}).join("");i.push(a)}u.push(i.join(`
`))}return u.join(`
`)}function Er(e,t){if(!e||e.length===0)return"";let u=or(e),n=u.length;if(n===0)return"";let{stdoutColumns:r,columns:o}=tr(t);if(o.length>n)throw new Error(`${o.length} columns defined, but only ${n} columns found`);let D=ar(r,o,u);return e.map(i=>gr(D,i)).join(`
`)}$();var yr=["<",">","=",">=","<="];function br(e){if(!yr.includes(e))throw new TypeError(`Invalid breakpoint operator: ${e}`)}function wr(e){let t=Object.keys(e).map(u=>{let[n,r]=u.split(" ");br(n);let o=Number.parseInt(r,10);if(Number.isNaN(o))throw new TypeError(`Invalid breakpoint value: ${r}`);let D=e[u];return{operator:n,breakpoint:o,value:D}}).sort((u,n)=>n.breakpoint-u.breakpoint);return u=>{var n;return(n=t.find(({operator:r,breakpoint:o})=>r==="="&&u===o||r===">"&&u>o||r==="<"&&u<o||r===">="&&u>=o||r==="<="&&u<=o))==null?void 0:n.value}}const Br=e=>e.replace(/[\W_]([a-z\d])?/gi,(t,u)=>u?u.toUpperCase():""),$r=e=>e.replace(/\B([A-Z])/g,"-$1").toLowerCase(),vr={"> 80":[{width:"content-width",paddingLeft:2,paddingRight:8},{width:"auto"}],"> 40":[{width:"auto",paddingLeft:2,paddingRight:8,preprocess:e=>e.trim()},{width:"100%",paddingLeft:2,paddingBottom:1}],"> 0":{stdoutColumns:1e3,columns:[{width:"content-width",paddingLeft:2,paddingRight:8},{width:"content-width"}]}};function Ar(e){let t=!1;return{type:"table",data:{tableData:Object.keys(e).sort((u,n)=>u.localeCompare(n)).map(u=>{const n=e[u],r="alias"in n;return r&&(t=!0),{name:u,flag:n,flagFormatted:`--${$r(u)}`,aliasesEnabled:t,aliasFormatted:r?`-${n.alias}`:void 0}}).map(u=>(u.aliasesEnabled=t,[{type:"flagName",data:u},{type:"flagDescription",data:u}])),tableBreakpoints:vr}}}const Yt=e=>!e||(e.version??(e.help?e.help.version:void 0)),Jt=e=>{const t="parent"in e&&e.parent?.name;return(t?`${t} `:"")+e.name};function xr(e){const t=[];e.name&&t.push(Jt(e));const u=Yt(e)??("parent"in e&&Yt(e.parent));if(u&&t.push(`v${u}`),t.length!==0)return{id:"name",type:"text",data:`${t.join(" ")}
`}}function Sr(e){const{help:t}=e;if(!(!t||!t.description))return{id:"description",type:"text",data:`${t.description}
`}}function Or(e){const t=e.help||{};if("usage"in t)return t.usage?{id:"usage",type:"section",data:{title:"Usage:",body:Array.isArray(t.usage)?t.usage.join(`
`):t.usage}}:void 0;if(e.name){const u=[],n=[Jt(e)];if(e.flags&&Object.keys(e.flags).length>0&&n.push("[flags...]"),e.parameters&&e.parameters.length>0){const{parameters:r}=e,o=r.indexOf("--"),D=o>-1&&r.slice(o+1).some(i=>i.startsWith("<"));n.push(r.map(i=>i!=="--"?i:D?"--":"[--]").join(" "))}if(n.length>1&&u.push(n.join(" ")),"commands"in e&&e.commands?.length&&u.push(`${e.name} <command>`),u.length>0)return{id:"usage",type:"section",data:{title:"Usage:",body:u.join(`
`)}}}}function Pr(e){return!("commands"in e)||!e.commands?.length?void 0:{id:"commands",type:"section",data:{title:"Commands:",body:{type:"table",data:{tableData:e.commands.map(t=>[t.options.name,t.options.help?t.options.help.description:""]),tableOptions:[{width:"content-width",paddingLeft:2,paddingRight:8}]}},indentBody:0}}}function Tr(e){if(!(!e.flags||Object.keys(e.flags).length===0))return{id:"flags",type:"section",data:{title:"Flags:",body:Ar(e.flags),indentBody:0}}}function Ir(e){const{help:t}=e;if(!t||!t.examples||t.examples.length===0)return;let{examples:u}=t;if(Array.isArray(u)&&(u=u.join(`
`)),u)return{id:"examples",type:"section",data:{title:"Examples:",body:u}}}function _r(e){if(!("alias"in e)||!e.alias)return;const{alias:t}=e;return{id:"aliases",type:"section",data:{title:"Aliases:",body:Array.isArray(t)?t.join(", "):t}}}const kr=e=>[xr,Sr,Or,Pr,Tr,Ir,_r].map(t=>t(e)).filter(Boolean),Rr=Bt.WriteStream.prototype.hasColors();class jr{text(t){return t}bold(t){return Rr?`\x1B[1m${t}\x1B[22m`:t.toLocaleUpperCase()}indentText({text:t,spaces:u}){return t.replace(/^/gm," ".repeat(u))}heading(t){return this.bold(t)}section({title:t,body:u,indentBody:n=2}){return`${(t?`${this.heading(t)}
`:"")+(u?this.indentText({text:this.render(u),spaces:n}):"")}
`}table({tableData:t,tableOptions:u,tableBreakpoints:n}){return Er(t.map(r=>r.map(o=>this.render(o))),n?wr(n):u)}flagParameter(t){return t===Boolean?"":t===String?"<string>":t===Number?"<number>":Array.isArray(t)?this.flagParameter(t[0]):"<value>"}flagOperator(t){return" "}flagName(t){const{flag:u,flagFormatted:n,aliasesEnabled:r,aliasFormatted:o}=t;let D="";if(o?D+=`${o}, `:r&&(D+="    "),D+=n,"placeholder"in u&&typeof u.placeholder=="string")D+=`${this.flagOperator(t)}${u.placeholder}`;else{const i=this.flagParameter("type"in u?u.type:u);i&&(D+=`${this.flagOperator(t)}${i}`)}return D}flagDefault(t){return JSON.stringify(t)}flagDescription({flag:t}){let u="description"in t?t.description??"":"";if("default"in t){let{default:n}=t;typeof n=="function"&&(n=n()),n&&(u+=` (default: ${this.flagDefault(n)})`)}return u}render(t){if(typeof t=="string")return t;if(Array.isArray(t))return t.map(u=>this.render(u)).join(`
`);if("type"in t&&this[t.type]){const u=this[t.type];if(typeof u=="function")return u.call(this,t.data)}throw new Error(`Invalid node type: ${JSON.stringify(t)}`)}}const Te=/^[\w.-]+$/,{stringify:O}=JSON,Mr=/[|\\{}()[\]^$+*?.]/;function Ie(e){const t=[];let u,n;for(const r of e){if(n)throw new Error(`Invalid parameter: Spread parameter ${O(n)} must be last`);const o=r[0],D=r[r.length-1];let i;if(o==="<"&&D===">"&&(i=!0,u))throw new Error(`Invalid parameter: Required parameter ${O(r)} cannot come after optional parameter ${O(u)}`);if(o==="["&&D==="]"&&(i=!1,u=r),i===void 0)throw new Error(`Invalid parameter: ${O(r)}. Must be wrapped in <> (required parameter) or [] (optional parameter)`);let s=r.slice(1,-1);const a=s.slice(-3)==="...";a&&(n=r,s=s.slice(0,-3));const l=s.match(Mr);if(l)throw new Error(`Invalid parameter: ${O(r)}. Invalid character found ${O(l[0])}`);t.push({name:s,required:i,spread:a})}return t}function _e(e,t,u,n){for(let r=0;r<t.length;r+=1){const{name:o,required:D,spread:i}=t[r],s=Br(o);if(s in e)throw new Error(`Invalid parameter: ${O(o)} is used more than once.`);const a=i?u.slice(r):u[r];if(i&&(r=t.length),D&&(!a||i&&a.length===0))return console.error(`Error: Missing required parameter ${O(o)}
`),n(),process.exit(1);e[s]=a}}function Nr(e){return e===void 0||e!==!1}function Xt(e,t,u,n){const r={...t.flags},o=t.version;o&&(r.version={type:Boolean,description:"Show version"});const{help:D}=t,i=Nr(D);i&&!("help"in r)&&(r.help={type:Boolean,alias:"h",description:"Show help"});const s=Gn(r,n,{ignore:t.ignoreArgv}),a=()=>{console.log(t.version)};if(o&&s.flags.version===!0)return a(),process.exit(0);const l=new jr,c=i&&D?.render?D.render:d=>l.render(d),f=d=>{const h=kr({...t,...d?{help:d}:{},flags:r});console.log(c(h,l))};if(i&&s.flags.help===!0)return f(),process.exit(0);if(t.parameters){let{parameters:d}=t,h=s._;const F=d.indexOf("--"),I=d.slice(F+1),P=Object.create(null);if(F>-1&&I.length>0){d=d.slice(0,F);const ne=s._["--"];h=h.slice(0,-ne.length||void 0),_e(P,Ie(d),h,f),_e(P,Ie(I),ne,f)}else _e(P,Ie(d),h,f);Object.assign(s._,P)}const p={...s,showVersion:a,showHelp:f};return typeof u=="function"&&u(p),{command:e,...p}}function Lr(e,t){const u=new Map;for(const n of t){const r=[n.options.name],{alias:o}=n.options;o&&(Array.isArray(o)?r.push(...o):r.push(o));for(const D of r){if(u.has(D))throw new Error(`Duplicate command name found: ${O(D)}`);u.set(D,n)}}return u.get(e)}function Gr(e,t,u=process.argv.slice(2)){if(!e)throw new Error("Options is required");if("name"in e&&(!e.name||!Te.test(e.name)))throw new Error(`Invalid script name: ${O(e.name)}`);const n=u[0];if(e.commands&&Te.test(n)){const r=Lr(n,e.commands);if(r)return Xt(r.options.name,{...r.options,parent:e},r.callback,u.slice(1))}return Xt(void 0,e,t,u)}function Zt(e,t){if(!e)throw new Error("Command options are required");const{name:u}=e;if(e.name===void 0)throw new Error("Command name is required");if(!Te.test(u))throw new Error(`Invalid command name ${JSON.stringify(u)}. Command names must be one word.`);return{options:e,callback:t}}var Qt="0.0.0-semantic-release",Ur="Writes your git commit messages for you with AI",b=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},k={},Wr={get exports(){return k},set exports(e){k=e}},ke,eu;function Hr(){if(eu)return ke;eu=1,ke=n,n.sync=r;var e=$e;function t(o,D){var i=D.pathExt!==void 0?D.pathExt:process.env.PATHEXT;if(!i||(i=i.split(";"),i.indexOf("")!==-1))return!0;for(var s=0;s<i.length;s++){var a=i[s].toLowerCase();if(a&&o.substr(-a.length).toLowerCase()===a)return!0}return!1}function u(o,D,i){return!o.isSymbolicLink()&&!o.isFile()?!1:t(D,i)}function n(o,D,i){e.stat(o,function(s,a){i(s,s?!1:u(a,o,D))})}function r(o,D){return u(e.statSync(o),o,D)}return ke}var Re,tu;function Kr(){if(tu)return Re;tu=1,Re=t,t.sync=u;var e=$e;function t(o,D,i){e.stat(o,function(s,a){i(s,s?!1:n(a,D))})}function u(o,D){return n(e.statSync(o),D)}function n(o,D){return o.isFile()&&r(o,D)}function r(o,D){var i=o.mode,s=o.uid,a=o.gid,l=D.uid!==void 0?D.uid:process.getuid&&process.getuid(),c=D.gid!==void 0?D.gid:process.getgid&&process.getgid(),f=parseInt("100",8),p=parseInt("010",8),d=parseInt("001",8),h=f|p,F=i&d||i&p&&a===c||i&f&&s===l||i&h&&l===0;return F}return Re}var ce;process.platform==="win32"||b.TESTING_WINDOWS?ce=Hr():ce=Kr();var qr=je;je.sync=zr;function je(e,t,u){if(typeof t=="function"&&(u=t,t={}),!u){if(typeof Promise!="function")throw new TypeError("callback not provided");return new Promise(function(n,r){je(e,t||{},function(o,D){o?r(o):n(D)})})}ce(e,t||{},function(n,r){n&&(n.code==="EACCES"||t&&t.ignoreErrors)&&(n=null,r=!1),u(n,r)})}function zr(e,t){try{return ce.sync(e,t||{})}catch(u){if(t&&t.ignoreErrors||u.code==="EACCES")return!1;throw u}}const G=process.platform==="win32"||process.env.OSTYPE==="cygwin"||process.env.OSTYPE==="msys",uu=L,Vr=G?";":":",nu=qr,ru=e=>Object.assign(new Error(`not found: ${e}`),{code:"ENOENT"}),ou=(e,t)=>{const u=t.colon||Vr,n=e.match(/\//)||G&&e.match(/\\/)?[""]:[...G?[process.cwd()]:[],...(t.path||process.env.PATH||"").split(u)],r=G?t.pathExt||process.env.PATHEXT||".EXE;.CMD;.BAT;.COM":"",o=G?r.split(u):[""];return G&&e.indexOf(".")!==-1&&o[0]!==""&&o.unshift(""),{pathEnv:n,pathExt:o,pathExtExe:r}},Du=(e,t,u)=>{typeof t=="function"&&(u=t,t={}),t||(t={});const{pathEnv:n,pathExt:r,pathExtExe:o}=ou(e,t),D=[],i=a=>new Promise((l,c)=>{if(a===n.length)return t.all&&D.length?l(D):c(ru(e));const f=n[a],p=/^".*"$/.test(f)?f.slice(1,-1):f,d=uu.join(p,e),h=!p&&/^\.[\\\/]/.test(e)?e.slice(0,2)+d:d;l(s(h,a,0))}),s=(a,l,c)=>new Promise((f,p)=>{if(c===r.length)return f(i(l+1));const d=r[c];nu(a+d,{pathExt:o},(h,F)=>{if(!h&&F)if(t.all)D.push(a+d);else return f(a+d);return f(s(a,l,c+1))})});return u?i(0).then(a=>u(null,a),u):i(0)},Yr=(e,t)=>{t=t||{};const{pathEnv:u,pathExt:n,pathExtExe:r}=ou(e,t),o=[];for(let D=0;D<u.length;D++){const i=u[D],s=/^".*"$/.test(i)?i.slice(1,-1):i,a=uu.join(s,e),l=!s&&/^\.[\\\/]/.test(e)?e.slice(0,2)+a:a;for(let c=0;c<n.length;c++){const f=l+n[c];try{if(nu.sync(f,{pathExt:r}))if(t.all)o.push(f);else return f}catch{}}}if(t.all&&o.length)return o;if(t.nothrow)return null;throw ru(e)};var Jr=Du;Du.sync=Yr;var le={},Xr={get exports(){return le},set exports(e){le=e}};const iu=(e={})=>{const t=e.env||process.env;return(e.platform||process.platform)!=="win32"?"PATH":Object.keys(t).reverse().find(n=>n.toUpperCase()==="PATH")||"Path"};Xr.exports=iu,le.default=iu;const su=L,Zr=Jr,Qr=le;function au(e,t){const u=e.options.env||process.env,n=process.cwd(),r=e.options.cwd!=null,o=r&&process.chdir!==void 0&&!process.chdir.disabled;if(o)try{process.chdir(e.options.cwd)}catch{}let D;try{D=Zr.sync(e.command,{path:u[Qr({env:u})],pathExt:t?su.delimiter:void 0})}catch{}finally{o&&process.chdir(n)}return D&&(D=su.resolve(r?e.options.cwd:"",D)),D}function eo(e){return au(e)||au(e,!0)}var to=eo,Me={};const Ne=/([()\][%!^"`<>&|;, *?])/g;function uo(e){return e=e.replace(Ne,"^$1"),e}function no(e,t){return e=`${e}`,e=e.replace(/(\\*)"/g,'$1$1\\"'),e=e.replace(/(\\*)$/,"$1$1"),e=`"${e}"`,e=e.replace(Ne,"^$1"),t&&(e=e.replace(Ne,"^$1")),e}Me.command=uo,Me.argument=no;var ro=/^#!(.*)/;const oo=ro;var Do=(e="")=>{const t=e.match(oo);if(!t)return null;const[u,n]=t[0].replace(/#! ?/,"").split(" "),r=u.split("/").pop();return r==="env"?n:n?`${r} ${n}`:r};const Le=$e,io=Do;function so(e){const u=Buffer.alloc(150);let n;try{n=Le.openSync(e,"r"),Le.readSync(n,u,0,150,0),Le.closeSync(n)}catch{}return io(u.toString())}var ao=so;const co=L,cu=to,lu=Me,lo=ao,fo=process.platform==="win32",po=/\.(?:com|exe)$/i,mo=/node_modules[\\/].bin[\\/][^\\/]+\.cmd$/i;function ho(e){e.file=cu(e);const t=e.file&&lo(e.file);return t?(e.args.unshift(e.file),e.command=t,cu(e)):e.file}function Fo(e){if(!fo)return e;const t=ho(e),u=!po.test(t);if(e.options.forceShell||u){const n=mo.test(t);e.command=co.normalize(e.command),e.command=lu.command(e.command),e.args=e.args.map(o=>lu.argument(o,n));const r=[e.command].concat(e.args).join(" ");e.args=["/d","/s","/c",`"${r}"`],e.command=process.env.comspec||"cmd.exe",e.options.windowsVerbatimArguments=!0}return e}function Co(e,t,u){t&&!Array.isArray(t)&&(u=t,t=null),t=t?t.slice(0):[],u=Object.assign({},u);const n={command:e,args:t,options:u,file:void 0,original:{command:e,args:t}};return u.shell?n:Fo(n)}var go=Co;const Ge=process.platform==="win32";function Ue(e,t){return Object.assign(new Error(`${t} ${e.command} ENOENT`),{code:"ENOENT",errno:"ENOENT",syscall:`${t} ${e.command}`,path:e.command,spawnargs:e.args})}function Eo(e,t){if(!Ge)return;const u=e.emit;e.emit=function(n,r){if(n==="exit"){const o=fu(r,t);if(o)return u.call(e,"error",o)}return u.apply(e,arguments)}}function fu(e,t){return Ge&&e===1&&!t.file?Ue(t.original,"spawn"):null}function yo(e,t){return Ge&&e===1&&!t.file?Ue(t.original,"spawnSync"):null}var bo={hookChildProcess:Eo,verifyENOENT:fu,verifyENOENTSync:yo,notFoundError:Ue};const pu=sn,We=go,He=bo;function du(e,t,u){const n=We(e,t,u),r=pu.spawn(n.command,n.args,n.options);return He.hookChildProcess(r,n),r}function wo(e,t,u){const n=We(e,t,u),r=pu.spawnSync(n.command,n.args,n.options);return r.error=r.error||He.verifyENOENTSync(r.status,n),r}Wr.exports=du,k.spawn=du,k.sync=wo,k._parse=We,k._enoent=He;function Bo(e){const t=typeof e=="string"?`
`:`
`.charCodeAt(),u=typeof e=="string"?"\r":"\r".charCodeAt();return e[e.length-1]===t&&(e=e.slice(0,-1)),e[e.length-1]===u&&(e=e.slice(0,-1)),e}function mu(e={}){const{env:t=process.env,platform:u=process.platform}=e;return u!=="win32"?"PATH":Object.keys(t).reverse().find(n=>n.toUpperCase()==="PATH")||"Path"}function $o(e={}){const{cwd:t=y.cwd(),path:u=y.env[mu()],execPath:n=y.execPath}=e;let r;const o=t instanceof URL?ln.fileURLToPath(t):t;let D=N.resolve(o);const i=[];for(;r!==D;)i.push(N.join(D,"node_modules/.bin")),r=D,D=N.resolve(D,"..");return i.push(N.resolve(o,n,"..")),[...i,u].join(N.delimiter)}function vo({env:e=y.env,...t}={}){e={...e};const u=mu({env:e});return t.path=e[u],e[u]=$o(t),e}const Ao=(e,t,u,n)=>{if(u==="length"||u==="prototype"||u==="arguments"||u==="caller")return;const r=Object.getOwnPropertyDescriptor(e,u),o=Object.getOwnPropertyDescriptor(t,u);!xo(r,o)&&n||Object.defineProperty(e,u,o)},xo=function(e,t){return e===void 0||e.configurable||e.writable===t.writable&&e.enumerable===t.enumerable&&e.configurable===t.configurable&&(e.writable||e.value===t.value)},So=(e,t)=>{const u=Object.getPrototypeOf(t);u!==Object.getPrototypeOf(e)&&Object.setPrototypeOf(e,u)},Oo=(e,t)=>`/* Wrapped ${e}*/
${t}`,Po=Object.getOwnPropertyDescriptor(Function.prototype,"toString"),To=Object.getOwnPropertyDescriptor(Function.prototype.toString,"name"),Io=(e,t,u)=>{const n=u===""?"":`with ${u.trim()}() `,r=Oo.bind(null,n,t.toString());Object.defineProperty(r,"name",To),Object.defineProperty(e,"toString",{...Po,value:r})};function _o(e,t,{ignoreNonConfigurable:u=!1}={}){const{name:n}=e;for(const r of Reflect.ownKeys(t))Ao(e,t,r,u);return So(e,t),Io(e,t,n),e}const fe=new WeakMap,hu=(e,t={})=>{if(typeof e!="function")throw new TypeError("Expected a function");let u,n=0;const r=e.displayName||e.name||"<anonymous>",o=function(...D){if(fe.set(o,++n),n===1)u=e.apply(this,D),e=null;else if(t.throw===!0)throw new Error(`Function \`${r}\` can only be called once`);return u};return _o(o,e),fe.set(o,n),o};hu.callCount=e=>{if(!fe.has(e))throw new Error(`The given function \`${e.name}\` is not wrapped by the \`onetime\` package`);return fe.get(e)};const ko=function(){const e=Cu-Fu+1;return Array.from({length:e},Ro)},Ro=function(e,t){return{name:`SIGRT${t+1}`,number:Fu+t,action:"terminate",description:"Application-specific signal (realtime)",standard:"posix"}},Fu=34,Cu=64,jo=[{name:"SIGHUP",number:1,action:"terminate",description:"Terminal closed",standard:"posix"},{name:"SIGINT",number:2,action:"terminate",description:"User interruption with CTRL-C",standard:"ansi"},{name:"SIGQUIT",number:3,action:"core",description:"User interruption with CTRL-\\",standard:"posix"},{name:"SIGILL",number:4,action:"core",description:"Invalid machine instruction",standard:"ansi"},{name:"SIGTRAP",number:5,action:"core",description:"Debugger breakpoint",standard:"posix"},{name:"SIGABRT",number:6,action:"core",description:"Aborted",standard:"ansi"},{name:"SIGIOT",number:6,action:"core",description:"Aborted",standard:"bsd"},{name:"SIGBUS",number:7,action:"core",description:"Bus error due to misaligned, non-existing address or paging error",standard:"bsd"},{name:"SIGEMT",number:7,action:"terminate",description:"Command should be emulated but is not implemented",standard:"other"},{name:"SIGFPE",number:8,action:"core",description:"Floating point arithmetic error",standard:"ansi"},{name:"SIGKILL",number:9,action:"terminate",description:"Forced termination",standard:"posix",forced:!0},{name:"SIGUSR1",number:10,action:"terminate",description:"Application-specific signal",standard:"posix"},{name:"SIGSEGV",number:11,action:"core",description:"Segmentation fault",standard:"ansi"},{name:"SIGUSR2",number:12,action:"terminate",description:"Application-specific signal",standard:"posix"},{name:"SIGPIPE",number:13,action:"terminate",description:"Broken pipe or socket",standard:"posix"},{name:"SIGALRM",number:14,action:"terminate",description:"Timeout or timer",standard:"posix"},{name:"SIGTERM",number:15,action:"terminate",description:"Termination",standard:"ansi"},{name:"SIGSTKFLT",number:16,action:"terminate",description:"Stack is empty or overflowed",standard:"other"},{name:"SIGCHLD",number:17,action:"ignore",description:"Child process terminated, paused or unpaused",standard:"posix"},{name:"SIGCLD",number:17,action:"ignore",description:"Child process terminated, paused or unpaused",standard:"other"},{name:"SIGCONT",number:18,action:"unpause",description:"Unpaused",standard:"posix",forced:!0},{name:"SIGSTOP",number:19,action:"pause",description:"Paused",standard:"posix",forced:!0},{name:"SIGTSTP",number:20,action:"pause",description:'Paused using CTRL-Z or "suspend"',standard:"posix"},{name:"SIGTTIN",number:21,action:"pause",description:"Background process cannot read terminal input",standard:"posix"},{name:"SIGBREAK",number:21,action:"terminate",description:"User interruption with CTRL-BREAK",standard:"other"},{name:"SIGTTOU",number:22,action:"pause",description:"Background process cannot write to terminal output",standard:"posix"},{name:"SIGURG",number:23,action:"ignore",description:"Socket received out-of-band data",standard:"bsd"},{name:"SIGXCPU",number:24,action:"core",description:"Process timed out",standard:"bsd"},{name:"SIGXFSZ",number:25,action:"core",description:"File too big",standard:"bsd"},{name:"SIGVTALRM",number:26,action:"terminate",description:"Timeout or timer",standard:"bsd"},{name:"SIGPROF",number:27,action:"terminate",description:"Timeout or timer",standard:"bsd"},{name:"SIGWINCH",number:28,action:"ignore",description:"Terminal window size changed",standard:"bsd"},{name:"SIGIO",number:29,action:"terminate",description:"I/O is available",standard:"other"},{name:"SIGPOLL",number:29,action:"terminate",description:"Watched event",standard:"other"},{name:"SIGINFO",number:29,action:"ignore",description:"Request for process information",standard:"other"},{name:"SIGPWR",number:30,action:"terminate",description:"Device running out of power",standard:"systemv"},{name:"SIGSYS",number:31,action:"core",description:"Invalid system call",standard:"other"},{name:"SIGUNUSED",number:31,action:"terminate",description:"Invalid system call",standard:"other"}],gu=function(){const e=ko();return[...jo,...e].map(Mo)},Mo=function({name:e,number:t,description:u,action:n,forced:r=!1,standard:o}){const{signals:{[e]:D}}=xt,i=D!==void 0;return{name:e,number:i?D:t,description:u,supported:i,action:n,forced:r,standard:o}},No=function(){const e=gu();return Object.fromEntries(e.map(Lo))},Lo=function({name:e,number:t,description:u,supported:n,action:r,forced:o,standard:D}){return[e,{name:e,number:t,description:u,supported:n,action:r,forced:o,standard:D}]},Go=No(),Uo=function(){const e=gu(),t=Cu+1,u=Array.from({length:t},(n,r)=>Wo(r,e));return Object.assign({},...u)},Wo=function(e,t){const u=Ho(e,t);if(u===void 0)return{};const{name:n,description:r,supported:o,action:D,forced:i,standard:s}=u;return{[e]:{name:n,number:e,description:r,supported:o,action:D,forced:i,standard:s}}},Ho=function(e,t){const u=t.find(({name:n})=>xt.signals[n]===e);return u!==void 0?u:t.find(n=>n.number===e)};Uo();const Ko=({timedOut:e,timeout:t,errorCode:u,signal:n,signalDescription:r,exitCode:o,isCanceled:D})=>e?`timed out after ${t} milliseconds`:D?"was canceled":u!==void 0?`failed with ${u}`:n!==void 0?`was killed with ${n} (${r})`:o!==void 0?`failed with exit code ${o}`:"failed",Eu=({stdout:e,stderr:t,all:u,error:n,signal:r,exitCode:o,command:D,escapedCommand:i,timedOut:s,isCanceled:a,killed:l,parsed:{options:{timeout:c}}})=>{o=o===null?void 0:o,r=r===null?void 0:r;const f=r===void 0?void 0:Go[r].description,p=n&&n.code,h=`Command ${Ko({timedOut:s,timeout:c,errorCode:p,signal:r,signalDescription:f,exitCode:o,isCanceled:a})}: ${D}`,F=Object.prototype.toString.call(n)==="[object Error]",I=F?`${h}
${n.message}`:h,P=[I,t,e].filter(Boolean).join(`
`);return F?(n.originalMessage=n.message,n.message=P):n=new Error(P),n.shortMessage=I,n.command=D,n.escapedCommand=i,n.exitCode=o,n.signal=r,n.signalDescription=f,n.stdout=e,n.stderr=t,u!==void 0&&(n.all=u),"bufferedData"in n&&delete n.bufferedData,n.failed=!0,n.timedOut=Boolean(s),n.isCanceled=a,n.killed=l&&!s,n},pe=["stdin","stdout","stderr"],qo=e=>pe.some(t=>e[t]!==void 0),zo=e=>{if(!e)return;const{stdio:t}=e;if(t===void 0)return pe.map(n=>e[n]);if(qo(e))throw new Error(`It's not possible to provide \`stdio\` in combination with one of ${pe.map(n=>`\`${n}\``).join(", ")}`);if(typeof t=="string")return t;if(!Array.isArray(t))throw new TypeError(`Expected \`stdio\` to be of type \`string\` or \`Array\`, got \`${typeof t}\``);const u=Math.max(t.length,pe.length);return Array.from({length:u},(n,r)=>t[r])};var U={},yu={get exports(){return U},set exports(e){U=e}},de={},Vo={get exports(){return de},set exports(e){de=e}},bu;function Yo(){return bu||(bu=1,function(e){e.exports=["SIGABRT","SIGALRM","SIGHUP","SIGINT","SIGTERM"],process.platform!=="win32"&&e.exports.push("SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT"),process.platform==="linux"&&e.exports.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT","SIGUNUSED")}(Vo)),de}var C=b.process;const R=function(e){return e&&typeof e=="object"&&typeof e.removeListener=="function"&&typeof e.emit=="function"&&typeof e.reallyExit=="function"&&typeof e.listeners=="function"&&typeof e.kill=="function"&&typeof e.pid=="number"&&typeof e.on=="function"};if(!R(C))yu.exports=function(){return function(){}};else{var Jo=St,J=Yo(),Xo=/^win/i.test(C.platform),me=Ot;typeof me!="function"&&(me=me.EventEmitter);var w;C.__signal_exit_emitter__?w=C.__signal_exit_emitter__:(w=C.__signal_exit_emitter__=new me,w.count=0,w.emitted={}),w.infinite||(w.setMaxListeners(1/0),w.infinite=!0),yu.exports=function(e,t){if(!R(b.process))return function(){};Jo.equal(typeof e,"function","a callback must be provided for exit handler"),X===!1&&wu();var u="exit";t&&t.alwaysLast&&(u="afterexit");var n=function(){w.removeListener(u,e),w.listeners("exit").length===0&&w.listeners("afterexit").length===0&&Ke()};return w.on(u,e),n};var Ke=function(){!X||!R(b.process)||(X=!1,J.forEach(function(t){try{C.removeListener(t,qe[t])}catch{}}),C.emit=ze,C.reallyExit=Bu,w.count-=1)};U.unload=Ke;var W=function(t,u,n){w.emitted[t]||(w.emitted[t]=!0,w.emit(t,u,n))},qe={};J.forEach(function(e){qe[e]=function(){if(R(b.process)){var u=C.listeners(e);u.length===w.count&&(Ke(),W("exit",null,e),W("afterexit",null,e),Xo&&e==="SIGHUP"&&(e="SIGINT"),C.kill(C.pid,e))}}}),U.signals=function(){return J};var X=!1,wu=function(){X||!R(b.process)||(X=!0,w.count+=1,J=J.filter(function(t){try{return C.on(t,qe[t]),!0}catch{return!1}}),C.emit=Qo,C.reallyExit=Zo)};U.load=wu;var Bu=C.reallyExit,Zo=function(t){R(b.process)&&(C.exitCode=t||0,W("exit",C.exitCode,null),W("afterexit",C.exitCode,null),Bu.call(C,C.exitCode))},ze=C.emit,Qo=function(t,u){if(t==="exit"&&R(b.process)){u!==void 0&&(C.exitCode=u);var n=ze.apply(this,arguments);return W("exit",C.exitCode,null),W("afterexit",C.exitCode,null),n}else return ze.apply(this,arguments)}}const eD=1e3*5,tD=(e,t="SIGTERM",u={})=>{const n=e(t);return uD(e,t,u,n),n},uD=(e,t,u,n)=>{if(!nD(t,u,n))return;const r=oD(u),o=setTimeout(()=>{e("SIGKILL")},r);o.unref&&o.unref()},nD=(e,{forceKillAfterTimeout:t},u)=>rD(e)&&t!==!1&&u,rD=e=>e===fn.constants.signals.SIGTERM||typeof e=="string"&&e.toUpperCase()==="SIGTERM",oD=({forceKillAfterTimeout:e=!0})=>{if(e===!0)return eD;if(!Number.isFinite(e)||e<0)throw new TypeError(`Expected the \`forceKillAfterTimeout\` option to be a non-negative integer, got \`${e}\` (${typeof e})`);return e},DD=(e,t)=>{e.kill()&&(t.isCanceled=!0)},iD=(e,t,u)=>{e.kill(t),u(Object.assign(new Error("Timed out"),{timedOut:!0,signal:t}))},sD=(e,{timeout:t,killSignal:u="SIGTERM"},n)=>{if(t===0||t===void 0)return n;let r;const o=new Promise((i,s)=>{r=setTimeout(()=>{iD(e,u,s)},t)}),D=n.finally(()=>{clearTimeout(r)});return Promise.race([o,D])},aD=({timeout:e})=>{if(e!==void 0&&(!Number.isFinite(e)||e<0))throw new TypeError(`Expected the \`timeout\` option to be a non-negative integer, got \`${e}\` (${typeof e})`)},cD=async(e,{cleanup:t,detached:u},n)=>{if(!t||u)return n;const r=U(()=>{e.kill()});return n.finally(()=>{r()})};function lD(e){return e!==null&&typeof e=="object"&&typeof e.pipe=="function"}var j={},fD={get exports(){return j},set exports(e){j=e}};const{PassThrough:pD}=ve;var dD=e=>{e={...e};const{array:t}=e;let{encoding:u}=e;const n=u==="buffer";let r=!1;t?r=!(u||n):u=u||"utf8",n&&(u=null);const o=new pD({objectMode:r});u&&o.setEncoding(u);let D=0;const i=[];return o.on("data",s=>{i.push(s),r?D=i.length:D+=s.length}),o.getBufferedValue=()=>t?i:n?Buffer.concat(i,D):i.join(""),o.getBufferedLength=()=>D,o};const{constants:mD}=pn,hD=ve,{promisify:FD}=dn,CD=dD,gD=FD(hD.pipeline);class $u extends Error{constructor(){super("maxBuffer exceeded"),this.name="MaxBufferError"}}async function Ve(e,t){if(!e)throw new Error("Expected a stream");t={maxBuffer:1/0,...t};const{maxBuffer:u}=t,n=CD(t);return await new Promise((r,o)=>{const D=i=>{i&&n.getBufferedLength()<=mD.MAX_LENGTH&&(i.bufferedData=n.getBufferedValue()),o(i)};(async()=>{try{await gD(e,n),r()}catch(i){D(i)}})(),n.on("data",()=>{n.getBufferedLength()>u&&D(new $u)})}),n.getBufferedValue()}fD.exports=Ve,j.buffer=(e,t)=>Ve(e,{...t,encoding:"buffer"}),j.array=(e,t)=>Ve(e,{...t,array:!0}),j.MaxBufferError=$u;const{PassThrough:ED}=ve;var yD=function(){var e=[],t=new ED({objectMode:!0});return t.setMaxListeners(0),t.add=u,t.isEmpty=n,t.on("unpipe",r),Array.prototype.slice.call(arguments).forEach(u),t;function u(o){return Array.isArray(o)?(o.forEach(u),this):(e.push(o),o.once("end",r.bind(null,o)),o.once("error",t.emit.bind(t,"error")),o.pipe(t,{end:!1}),this)}function n(){return e.length==0}function r(o){e=e.filter(function(D){return D!==o}),!e.length&&t.readable&&t.end()}};const bD=(e,t)=>{t!==void 0&&(lD(t)?t.pipe(e.stdin):e.stdin.end(t))},wD=(e,{all:t})=>{if(!t||!e.stdout&&!e.stderr)return;const u=yD();return e.stdout&&u.add(e.stdout),e.stderr&&u.add(e.stderr),u},Ye=async(e,t)=>{if(!(!e||t===void 0)){e.destroy();try{return await t}catch(u){return u.bufferedData}}},Je=(e,{encoding:t,buffer:u,maxBuffer:n})=>{if(!(!e||!u))return t?j(e,{encoding:t,maxBuffer:n}):j.buffer(e,{maxBuffer:n})},BD=async({stdout:e,stderr:t,all:u},{encoding:n,buffer:r,maxBuffer:o},D)=>{const i=Je(e,{encoding:n,buffer:r,maxBuffer:o}),s=Je(t,{encoding:n,buffer:r,maxBuffer:o}),a=Je(u,{encoding:n,buffer:r,maxBuffer:o*2});try{return await Promise.all([D,i,s,a])}catch(l){return Promise.all([{error:l,signal:l.signal,timedOut:l.timedOut},Ye(e,i),Ye(t,s),Ye(u,a)])}},$D=(async()=>{})().constructor.prototype,vD=["then","catch","finally"].map(e=>[e,Reflect.getOwnPropertyDescriptor($D,e)]),vu=(e,t)=>{for(const[u,n]of vD){const r=typeof t=="function"?(...o)=>Reflect.apply(n.value,t(),o):n.value.bind(t);Reflect.defineProperty(e,u,{...n,value:r})}return e},AD=e=>new Promise((t,u)=>{e.on("exit",(n,r)=>{t({exitCode:n,signal:r})}),e.on("error",n=>{u(n)}),e.stdin&&e.stdin.on("error",n=>{u(n)})}),Au=(e,t=[])=>Array.isArray(t)?[e,...t]:[e],xD=/^[\w.-]+$/,SD=/"/g,OD=e=>typeof e!="string"||xD.test(e)?e:`"${e.replace(SD,'\\"')}"`,PD=(e,t)=>Au(e,t).join(" "),TD=(e,t)=>Au(e,t).map(u=>OD(u)).join(" "),ID=1e3*1e3*100,_D=({env:e,extendEnv:t,preferLocal:u,localDir:n,execPath:r})=>{const o=t?{...y.env,...e}:e;return u?vo({env:o,cwd:n,execPath:r}):o},kD=(e,t,u={})=>{const n=k._parse(e,t,u);return e=n.command,t=n.args,u=n.options,u={maxBuffer:ID,buffer:!0,stripFinalNewline:!0,extendEnv:!0,preferLocal:!1,localDir:u.cwd||y.cwd(),execPath:y.execPath,encoding:"utf8",reject:!0,cleanup:!0,all:!1,windowsHide:!0,...u},u.env=_D(u),u.stdio=zo(u),y.platform==="win32"&&N.basename(e,".exe")==="cmd"&&t.unshift("/q"),{file:e,args:t,options:u,parsed:n}},Xe=(e,t,u)=>typeof t!="string"&&!Dn.isBuffer(t)?u===void 0?void 0:"":e.stripFinalNewline?Bo(t):t;function Z(e,t,u){const n=kD(e,t,u),r=PD(e,t),o=TD(e,t);aD(n.options);let D;try{D=$t.spawn(n.file,n.args,n.options)}catch(p){const d=new $t.ChildProcess,h=Promise.reject(Eu({error:p,stdout:"",stderr:"",all:"",command:r,escapedCommand:o,parsed:n,timedOut:!1,isCanceled:!1,killed:!1}));return vu(d,h)}const i=AD(D),s=sD(D,n.options,i),a=cD(D,n.options,s),l={isCanceled:!1};D.kill=tD.bind(null,D.kill.bind(D)),D.cancel=DD.bind(null,D,l);const f=hu(async()=>{const[{error:p,exitCode:d,signal:h,timedOut:F},I,P,ne]=await BD(D,n.options,a),Et=Xe(n.options,I),yt=Xe(n.options,P),bt=Xe(n.options,ne);if(p||d!==0||h!==null){const wt=Eu({error:p,exitCode:d,signal:h,stdout:Et,stderr:yt,all:bt,command:r,escapedCommand:o,parsed:n,timedOut:F,isCanceled:l.isCanceled||(n.options.signal?n.options.signal.aborted:!1),killed:D.killed});if(!n.options.reject)return wt;throw wt}return{command:r,escapedCommand:o,exitCode:0,stdout:Et,stderr:yt,all:bt,failed:!1,timedOut:!1,isCanceled:!1,killed:!1}});return bD(D,n.options.input),D.all=wD(D,n.options),vu(D,f)}let M=!0;const H=typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{};let xu=0;if(H.process&&H.process.env&&H.process.stdout){const{FORCE_COLOR:e,NODE_DISABLE_COLORS:t,NO_COLOR:u,TERM:n}=H.process.env;t||u||e==="0"?M=!1:e==="1"||e==="2"||e==="3"?M=!0:n==="dumb"?M=!1:"CI"in H.process.env&&["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE","DRONE"].some(r=>r in H.process.env)?M=!0:M=process.stdout.isTTY,M&&(xu=n&&n.endsWith("-256color")?2:1)}let Su={enabled:M,supportLevel:xu};function Q(e,t,u=1){const n=`\x1B[${e}m`,r=`\x1B[${t}m`,o=new RegExp(`\\x1b\\[${t}m`,"g");return D=>Su.enabled&&Su.supportLevel>=u?n+(""+D).replace(o,n)+r:""+D}const Ze=Q(2,22),Ou=Q(30,39),he=Q(31,39),Fe=Q(32,39),Pu=Q(46,49),Qe="\x1B",E=`${Qe}[`,RD="\x07",et={to(e,t){return t?`${E}${t+1};${e+1}H`:`${E}${e+1}G`},move(e,t){let u="";return e<0?u+=`${E}${-e}D`:e>0&&(u+=`${E}${e}C`),t<0?u+=`${E}${-t}A`:t>0&&(u+=`${E}${t}B`),u},up:(e=1)=>`${E}${e}A`,down:(e=1)=>`${E}${e}B`,forward:(e=1)=>`${E}${e}C`,backward:(e=1)=>`${E}${e}D`,nextLine:(e=1)=>`${E}E`.repeat(e),prevLine:(e=1)=>`${E}F`.repeat(e),left:`${E}G`,hide:`${E}?25l`,show:`${E}?25h`,save:`${Qe}7`,restore:`${Qe}8`},jD={up:(e=1)=>`${E}S`.repeat(e),down:(e=1)=>`${E}T`.repeat(e)},MD={screen:`${E}2J`,up:(e=1)=>`${E}1J`.repeat(e),down:(e=1)=>`${E}J`.repeat(e),line:`${E}2K`,lineEnd:`${E}K`,lineStart:`${E}1K`,lines(e){let t="";for(let u=0;u<e;u++)t+=this.line+(u<e-1?et.up():"");return e&&(t+=et.left),t}};var B={cursor:et,scroll:jD,erase:MD,beep:RD},m={},ND={get exports(){return m},set exports(e){m=e}};let LD=Bt,GD=!("NO_COLOR"in process.env||process.argv.includes("--no-color"))&&("FORCE_COLOR"in process.env||process.argv.includes("--color")||process.platform==="win32"||LD.isatty(1)&&process.env.TERM!=="dumb"||"CI"in process.env),g=(e,t,u=e)=>n=>{let r=""+n,o=r.indexOf(t,e.length);return~o?e+Tu(r,t,u,o)+t:e+r+t},Tu=(e,t,u,n)=>{let r=e.substring(0,n)+u,o=e.substring(n+t.length),D=o.indexOf(t);return~D?r+Tu(o,t,u,D):r+o},Iu=(e=GD)=>({isColorSupported:e,reset:e?t=>`\x1B[0m${t}\x1B[0m`:String,bold:e?g("\x1B[1m","\x1B[22m","\x1B[22m\x1B[1m"):String,dim:e?g("\x1B[2m","\x1B[22m","\x1B[22m\x1B[2m"):String,italic:e?g("\x1B[3m","\x1B[23m"):String,underline:e?g("\x1B[4m","\x1B[24m"):String,inverse:e?g("\x1B[7m","\x1B[27m"):String,hidden:e?g("\x1B[8m","\x1B[28m"):String,strikethrough:e?g("\x1B[9m","\x1B[29m"):String,black:e?g("\x1B[30m","\x1B[39m"):String,red:e?g("\x1B[31m","\x1B[39m"):String,green:e?g("\x1B[32m","\x1B[39m"):String,yellow:e?g("\x1B[33m","\x1B[39m"):String,blue:e?g("\x1B[34m","\x1B[39m"):String,magenta:e?g("\x1B[35m","\x1B[39m"):String,cyan:e?g("\x1B[36m","\x1B[39m"):String,white:e?g("\x1B[37m","\x1B[39m"):String,gray:e?g("\x1B[90m","\x1B[39m"):String,bgBlack:e?g("\x1B[40m","\x1B[49m"):String,bgRed:e?g("\x1B[41m","\x1B[49m"):String,bgGreen:e?g("\x1B[42m","\x1B[49m"):String,bgYellow:e?g("\x1B[43m","\x1B[49m"):String,bgBlue:e?g("\x1B[44m","\x1B[49m"):String,bgMagenta:e?g("\x1B[45m","\x1B[49m"):String,bgCyan:e?g("\x1B[46m","\x1B[49m"):String,bgWhite:e?g("\x1B[47m","\x1B[49m"):String});ND.exports=Iu(),m.createColors=Iu;function UD(e,t){if(e===t)return;const u=e.split(`
`),n=t.split(`
`),r=[];for(let o=0;o<Math.max(u.length,n.length);o++)u[o]!==n[o]&&r.push(o);return r}const _u=Symbol("clack:cancel");function ku(e){return e===_u}function Ce(e,t){e.isTTY&&e.setRawMode(t)}const Ru=new Map([["k","up"],["j","down"],["h","left"],["l","right"]]),WD=new Set(["up","down","left","right","space","enter"]);class ju{constructor({render:t,input:u=vt,output:n=At,...r},o=!0){this._track=!1,this._cursor=0,this.state="initial",this.error="",this.subscribers=new Map,this._prevFrame="",this.opts=r,this.onKeypress=this.onKeypress.bind(this),this.close=this.close.bind(this),this.render=this.render.bind(this),this._render=t.bind(this),this._track=o,this.input=u,this.output=n}prompt(){const t=new mn(0);return t._write=(u,n,r)=>{this._track&&(this.value=this.rl.line.replace(/\t/g,""),this._cursor=this.rl.cursor,this.emit("value",this.value)),r()},this.input.pipe(t),this.rl=Pt.createInterface({input:this.input,output:t,tabSize:2,prompt:"",escapeCodeTimeout:50}),Pt.emitKeypressEvents(this.input,this.rl),this.rl.prompt(),this.opts.initialValue!==void 0&&this._track&&this.rl.write(this.opts.initialValue),this.input.on("keypress",this.onKeypress),Ce(this.input,!0),this.render(),new Promise((u,n)=>{this.once("submit",()=>{this.output.write(B.cursor.show),Ce(this.input,!1),u(this.value)}),this.once("cancel",()=>{this.output.write(B.cursor.show),Ce(this.input,!1),u(_u)})})}on(t,u){const n=this.subscribers.get(t)??[];n.push({cb:u}),this.subscribers.set(t,n)}once(t,u){const n=this.subscribers.get(t)??[];n.push({cb:u,once:!0}),this.subscribers.set(t,n)}emit(t,...u){const n=this.subscribers.get(t)??[],r=[];for(const o of n)o.cb(...u),o.once&&r.push(()=>n.splice(n.indexOf(o),1));for(const o of r)o()}unsubscribe(){this.subscribers.clear()}onKeypress(t,u){if(this.state==="error"&&(this.state="active"),u?.name&&!this._track&&Ru.has(u.name)&&this.emit("cursor",Ru.get(u.name)),u?.name&&WD.has(u.name)&&this.emit("cursor",u.name),t&&(t.toLowerCase()==="y"||t.toLowerCase()==="n")&&this.emit("confirm",t.toLowerCase()==="y"),t&&this.emit("key",t.toLowerCase()),u?.name==="return"){if(this.opts.validate){const n=this.opts.validate(this.value);n&&(this.error=n,this.state="error",this.rl.write(this.value))}this.state!=="error"&&(this.state="submit")}t===""&&(this.state="cancel"),(this.state==="submit"||this.state==="cancel")&&this.emit("finalize"),this.render(),(this.state==="submit"||this.state==="cancel")&&this.close()}close(){this.input.unpipe(),this.input.removeListener("keypress",this.onKeypress),this.output.write(`
`),Ce(this.input,!1),this.rl.close(),this.emit(`${this.state}`,this.value),this.unsubscribe()}restoreCursor(){const t=this._prevFrame.split(`
`).length-1;this.output.write(B.cursor.move(-999,t*-1))}render(){const t=this._render(this)??"";if(t!==this._prevFrame){if(this.state==="initial")this.output.write(B.cursor.hide);else{const u=UD(this._prevFrame,t);if(this.restoreCursor(),u&&u?.length===1){const n=u[0];this.output.write(B.cursor.move(0,n)),this.output.write(B.erase.lines(1));const r=t.split(`
`);this.output.write(r[n]),this._prevFrame=t,this.output.write(B.cursor.move(0,r.length-n-1));return}else if(u&&u?.length>1){const n=u[0];this.output.write(B.cursor.move(0,n)),this.output.write(B.erase.down());const r=t.split(`
`).slice(n);this.output.write(r.join(`
`)),this._prevFrame=t;return}this.output.write(B.erase.down())}this.output.write(t),this.state==="initial"&&(this.state="active"),this._prevFrame=t}}}class HD extends ju{get cursor(){return this.value?0:1}get _value(){return this.cursor===0}constructor(t){super(t,!1),this.value=!!t.initialValue,this.on("value",()=>{this.value=this._value}),this.on("confirm",u=>{this.output.write(B.cursor.move(0,-1)),this.value=u,this.state="submit",this.close()}),this.on("cursor",()=>{this.value=!this.value})}}class KD extends ju{constructor(t){super(t,!1),this.cursor=0,this.options=t.options,this.cursor=this.options.findIndex(({value:u})=>u===t.initialValue),this.cursor===-1&&(this.cursor=0),this.changeValue(),this.on("cursor",u=>{switch(u){case"left":case"up":this.cursor=this.cursor===0?this.options.length-1:this.cursor-1;break;case"down":case"right":this.cursor=this.cursor===this.options.length-1?0:this.cursor+1;break}this.changeValue()})}get _value(){return this.options[this.cursor]}changeValue(){this.value=this._value.value}}function qD({input:e=vt,output:t=At,overwrite:u=!0,hideCursor:n=!0}={}){const r=re.createInterface({input:e,output:t,prompt:"",tabSize:1});re.emitKeypressEvents(e,r),e.isTTY&&e.setRawMode(!0);const o=(D,{name:i})=>{if(String(D)===""&&process.exit(0),!u)return;let s=i==="return"?0:-1,a=i==="return"?-1:0;re.moveCursor(t,s,a,()=>{re.clearLine(t,1,()=>{e.once("keypress",o)})})};return n&&process.stdout.write(B.cursor.hide),e.once("keypress",o),()=>{e.off("keypress",o),n&&process.stdout.write(B.cursor.show),r.terminal=!1,r.close()}}function zD(){return y.platform!=="win32"?y.env.TERM!=="linux":Boolean(y.env.CI)||Boolean(y.env.WT_SESSION)||Boolean(y.env.TERMINUS_SUBLIME)||y.env.ConEmuTask==="{cmd::Cmder}"||y.env.TERM_PROGRAM==="Terminus-Sublime"||y.env.TERM_PROGRAM==="vscode"||y.env.TERM==="xterm-256color"||y.env.TERM==="alacritty"||y.env.TERMINAL_EMULATOR==="JetBrains-JediTerm"}const tt=zD(),T=(e,t)=>tt?e:t,VD=T("\u25C6","*"),YD=T("\u25A0","x"),JD=T("\u25B2","x"),Mu=T("\u25C7","o"),XD=T("\u250C","T"),v=T("\u2502","|"),ut=T("\u2514","\u2014"),nt=T("\u25CF",">"),rt=T("\u25CB"," "),Nu=e=>{switch(e){case"initial":case"active":return m.cyan(VD);case"cancel":return m.red(YD);case"error":return m.yellow(JD);case"submit":return m.green(Mu)}},ZD=e=>{const t=e.active??"Yes",u=e.inactive??"No";return new HD({active:t,inactive:u,initialValue:e.initialValue??!0,render(){const n=`${m.gray(v)}
${Nu(this.state)}  ${e.message}
`,r=this.value?t:u;switch(this.state){case"submit":return`${n}${m.gray(v)}  ${m.dim(r)}`;case"cancel":return`${n}${m.gray(v)}  ${m.strikethrough(m.dim(r))}
${m.gray(v)}`;default:return`${n}${m.cyan(v)}  ${this.value?`${m.green(nt)} ${t}`:`${m.dim(rt)} ${m.dim(t)}`} ${m.dim("/")} ${this.value?`${m.dim(rt)} ${m.dim(u)}`:`${m.green(nt)} ${u}`}
${m.cyan(ut)}
`}}}).prompt()},QD=e=>{const t=(u,n)=>{const r=u.label??String(u.value);return n==="active"?`${m.green(nt)} ${r} ${u.hint?m.dim(`(${u.hint})`):""}`:n==="selected"?`${m.dim(r)}`:n==="cancelled"?`${m.strikethrough(m.dim(r))}`:`${m.dim(rt)} ${m.dim(r)}`};return new KD({options:e.options,initialValue:e.initialValue,render(){const u=`${m.gray(v)}
${Nu(this.state)}  ${e.message}
`;switch(this.state){case"submit":return`${u}${m.gray(v)}  ${t(this.options[this.cursor],"selected")}`;case"cancel":return`${u}${m.gray(v)}  ${t(this.options[this.cursor],"cancelled")}
${m.gray(v)}`;default:return`${u}${m.cyan(v)}  ${this.options.map((n,r)=>t(n,r===this.cursor?"active":"inactive")).join(`
${m.cyan(v)}  `)}
${m.cyan(ut)}
`}}}).prompt()},Lu=(e="")=>{process.stdout.write(`${m.gray(XD)}  ${e}
`)},K=(e="")=>{process.stdout.write(`${m.gray(v)}
${m.gray(ut)}  ${e}

`)},ot=tt?["\u25D2","\u25D0","\u25D3","\u25D1"]:["\u2022","o","O","0"],Dt=()=>{let e,t;const u=tt?80:120;return{start(n=""){n=n.replace(/\.?\.?\.$/,""),e=qD(),process.stdout.write(`${m.gray(v)}
${m.magenta("\u25CB")}  ${n}
`);let r=0,o=0;t=setInterval(()=>{let D=ot[r];process.stdout.write(B.cursor.move(-999,-1)),process.stdout.write(`${m.magenta(D)}  ${n}${Math.floor(o)>=1?".".repeat(Math.floor(o)).slice(0,3):""}   
`),r=r===ot.length-1?0:r+1,o=o===ot.length?0:o+.125},u)},stop(n=""){process.stdout.write(B.cursor.move(-999,-2)),process.stdout.write(B.erase.down(2)),clearInterval(t),process.stdout.write(`${m.gray(v)}
${m.green(Mu)}  ${n}
`),e()}}};class A extends Error{}const it="    ",ge=e=>{e instanceof Error&&!(e instanceof A)&&(e.stack&&console.error(Ze(e.stack.split(`
`).slice(1).join(`
`))),console.error(`
${it}${Ze(`aicommits v${Qt}`)}`),console.error(`
${it}Please open a Bug report with the information above:`),console.error(`${it}https://github.com/Nutlope/aicommits/issues/new/choose`))},Gu=async()=>{const{stdout:e,failed:t}=await Z("git",["rev-parse","--show-toplevel"],{reject:!1});if(t)throw new A("The current directory must be a Git repository!");return e},st=e=>`:(exclude)${e}`,Uu=["package-lock.json","pnpm-lock.yaml","*.lock"].map(st),Wu=async e=>{const t=["diff","--cached","--diff-algorithm=minimal"],{stdout:u}=await Z("git",[...t,"--name-only",...Uu,...e?e.map(st):[]]);if(!u)return;const{stdout:n}=await Z("git",[...t,"--word-diff=porcelain","--unified=15",...Uu,...e?e.map(st):[]]);return{files:u.split(`
`),diff:n}},ei=e=>`Detected ${e.length.toLocaleString()} staged file${e.length>1?"s":""}`,{hasOwnProperty:at}=Object.prototype,Ee=typeof process<"u"&&process.platform==="win32"?`\r
`:`
`,ct=(e,t)=>{const u=[];let n="";typeof t=="string"?t={section:t,whitespace:!1}:(t=t||Object.create(null),t.whitespace=t.whitespace===!0);const r=t.whitespace?" = ":"=";for(const o of Object.keys(e)){const D=e[o];if(D&&Array.isArray(D))for(const i of D)n+=q(o+"[]")+r+q(i)+Ee;else D&&typeof D=="object"?u.push(o):n+=q(o)+r+q(D)+Ee}t.section&&n.length&&(n="["+q(t.section)+"]"+Ee+n);for(const o of u){const D=Hu(o).join("\\."),i=(t.section?t.section+".":"")+D,{whitespace:s}=t,a=ct(e[o],{section:i,whitespace:s});n.length&&a.length&&(n+=Ee),n+=a}return n},Hu=e=>e.replace(/\1/g,"LITERAL\\1LITERAL").replace(/\\\./g,"").split(/\./).map(t=>t.replace(/\1/g,"\\.").replace(/\2LITERAL\\1LITERAL\2/g,"")),Ku=e=>{const t=Object.create(null);let u=t,n=null;const r=/^\[([^\]]*)\]$|^([^=]+)(=(.*))?$/i,o=e.split(/[\r\n]+/g);for(const i of o){if(!i||i.match(/^\s*[;#]/))continue;const s=i.match(r);if(!s)continue;if(s[1]!==void 0){if(n=ye(s[1]),n==="__proto__"){u=Object.create(null);continue}u=t[n]=t[n]||Object.create(null);continue}const a=ye(s[2]),l=a.length>2&&a.slice(-2)==="[]",c=l?a.slice(0,-2):a;if(c==="__proto__")continue;const f=s[3]?ye(s[4]):!0,p=f==="true"||f==="false"||f==="null"?JSON.parse(f):f;l&&(at.call(u,c)?Array.isArray(u[c])||(u[c]=[u[c]]):u[c]=[]),Array.isArray(u[c])?u[c].push(p):u[c]=p}const D=[];for(const i of Object.keys(t)){if(!at.call(t,i)||typeof t[i]!="object"||Array.isArray(t[i]))continue;const s=Hu(i);u=t;const a=s.pop(),l=a.replace(/\\\./g,".");for(const c of s)c!=="__proto__"&&((!at.call(u,c)||typeof u[c]!="object")&&(u[c]=Object.create(null)),u=u[c]);u===t&&l===a||(u[l]=t[i],D.push(i))}for(const i of D)delete t[i];return t},qu=e=>e.startsWith('"')&&e.endsWith('"')||e.startsWith("'")&&e.endsWith("'"),q=e=>typeof e!="string"||e.match(/[=\r\n]/)||e.match(/^\[/)||e.length>1&&qu(e)||e!==e.trim()?JSON.stringify(e):e.split(";").join("\\;").split("#").join("\\#"),ye=(e,t)=>{if(e=(e||"").trim(),qu(e)){e.charAt(0)==="'"&&(e=e.slice(1,-1));try{e=JSON.parse(e)}catch{}}else{let u=!1,n="";for(let r=0,o=e.length;r<o;r++){const D=e.charAt(r);if(u)"\\;#".indexOf(D)!==-1?n+=D:n+="\\"+D,u=!1;else{if(";#".indexOf(D)!==-1)break;D==="\\"?u=!0:n+=D}}return u&&(n+="\\"),n.trim()}return e};var zu={parse:Ku,decode:Ku,stringify:ct,encode:ct,safe:q,unsafe:ye};const Vu=e=>x.lstat(e).then(()=>!0,()=>!1),ti=["","conventional"],{hasOwnProperty:ui}=Object.prototype,Yu=(e,t)=>ui.call(e,t),S=(e,t,u)=>{if(!t)throw new A(`Invalid config property ${e}: ${u}`)},be={OPENAI_KEY(e){if(!e)throw new A("Please set your OpenAI API key via `aicommits config set OPENAI_KEY=<your token>`");return S("OPENAI_KEY",e.startsWith("sk-"),'Must start with "sk-"'),e},locale(e){return e?(S("locale",e,"Cannot be empty"),S("locale",/^[a-z-]+$/i.test(e),"Must be a valid locale (letters and dashes/underscores). You can consult the list of codes in: https://wikipedia.org/wiki/List_of_ISO_639-1_codes"),e):"en"},generate(e){if(!e)return 1;S("generate",/^\d+$/.test(e),"Must be an integer");const t=Number(e);return S("generate",t>0,"Must be greater than 0"),S("generate",t<=5,"Must be less or equal to 5"),t},type(e){return e?(S("type",ti.includes(e),"Invalid commit type"),e):""},proxy(e){if(!(!e||e.length===0))return S("proxy",/^https?:\/\//.test(e),"Must be a valid URL"),e},model(e){return!e||e.length===0?"gpt-3.5-turbo":e},timeout(e){if(!e)return 1e4;S("timeout",/^\d+$/.test(e),"Must be an integer");const t=Number(e);return S("timeout",t>=500,"Must be greater than 500ms"),t},"max-length"(e){if(!e)return 50;S("max-length",/^\d+$/.test(e),"Must be an integer");const t=Number(e);return S("max-length",t>=20,"Must be greater than 20 characters"),t}},lt=L.join(hn.homedir(),".aicommits"),Ju=async()=>{if(!await Vu(lt))return Object.create(null);const t=await x.readFile(lt,"utf8");return zu.parse(t)},ft=async(e,t)=>{const u=await Ju(),n={};for(const r of Object.keys(be)){const o=be[r],D=e?.[r]??u[r];if(t)try{n[r]=o(D)}catch{}else n[r]=o(D)}return n},ni=async e=>{const t=await Ju();for(const[u,n]of e){if(!Yu(be,u))throw new A(`Invalid config property: ${u}`);const r=be[u](n);t[u]=r}await x.writeFile(lt,zu.stringify(t),"utf8")};var pt={},dt={};Object.defineProperty(dt,"__esModule",{value:!0});function ri(e){return function(t,u){return new Promise((n,r)=>{e.call(this,t,u,(o,D)=>{o?r(o):n(D)})})}}dt.default=ri;var Xu=b&&b.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};const oi=Ot,Di=Xu(oe),ii=Xu(dt),ee=Di.default("agent-base");function si(e){return Boolean(e)&&typeof e.addRequest=="function"}function mt(){const{stack:e}=new Error;return typeof e!="string"?!1:e.split(`
`).some(t=>t.indexOf("(https.js:")!==-1||t.indexOf("node:https:")!==-1)}function we(e,t){return new we.Agent(e,t)}(function(e){class t extends oi.EventEmitter{constructor(n,r){super();let o=r;typeof n=="function"?this.callback=n:n&&(o=n),this.timeout=null,o&&typeof o.timeout=="number"&&(this.timeout=o.timeout),this.maxFreeSockets=1,this.maxSockets=1,this.maxTotalSockets=1/0,this.sockets={},this.freeSockets={},this.requests={},this.options={}}get defaultPort(){return typeof this.explicitDefaultPort=="number"?this.explicitDefaultPort:mt()?443:80}set defaultPort(n){this.explicitDefaultPort=n}get protocol(){return typeof this.explicitProtocol=="string"?this.explicitProtocol:mt()?"https:":"http:"}set protocol(n){this.explicitProtocol=n}callback(n,r,o){throw new Error('"agent-base" has no default implementation, you must subclass and override `callback()`')}addRequest(n,r){const o=Object.assign({},r);typeof o.secureEndpoint!="boolean"&&(o.secureEndpoint=mt()),o.host==null&&(o.host="localhost"),o.port==null&&(o.port=o.secureEndpoint?443:80),o.protocol==null&&(o.protocol=o.secureEndpoint?"https:":"http:"),o.host&&o.path&&delete o.path,delete o.agent,delete o.hostname,delete o._defaultAgent,delete o.defaultPort,delete o.createConnection,n._last=!0,n.shouldKeepAlive=!1;let D=!1,i=null;const s=o.timeout||this.timeout,a=p=>{n._hadError||(n.emit("error",p),n._hadError=!0)},l=()=>{i=null,D=!0;const p=new Error(`A "socket" was not created for HTTP request before ${s}ms`);p.code="ETIMEOUT",a(p)},c=p=>{D||(i!==null&&(clearTimeout(i),i=null),a(p))},f=p=>{if(D)return;if(i!=null&&(clearTimeout(i),i=null),si(p)){ee("Callback returned another Agent instance %o",p.constructor.name),p.addRequest(n,o);return}if(p){p.once("free",()=>{this.freeSocket(p,o)}),n.onSocket(p);return}const d=new Error(`no Duplex stream was returned to agent-base for \`${n.method} ${n.path}\``);a(d)};if(typeof this.callback!="function"){a(new Error("`callback` is not defined"));return}this.promisifiedCallback||(this.callback.length>=3?(ee("Converting legacy callback function to promise"),this.promisifiedCallback=ii.default(this.callback)):this.promisifiedCallback=this.callback),typeof s=="number"&&s>0&&(i=setTimeout(l,s)),"port"in o&&typeof o.port!="number"&&(o.port=Number(o.port));try{ee("Resolving socket for %o request: %o",o.protocol,`${n.method} ${n.path}`),Promise.resolve(this.promisifiedCallback(n,o)).then(f,c)}catch(p){Promise.reject(p).catch(c)}}freeSocket(n,r){ee("Freeing socket %o %o",n.constructor.name,r),n.destroy()}destroy(){ee("Destroying agent %o",this.constructor.name)}}e.Agent=t,e.prototype=e.Agent.prototype})(we||(we={}));var ai=we,ht={},ci=b&&b.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ht,"__esModule",{value:!0});const li=ci(oe),te=li.default("https-proxy-agent:parse-proxy-response");function fi(e){return new Promise((t,u)=>{let n=0;const r=[];function o(){const c=e.read();c?l(c):e.once("readable",o)}function D(){e.removeListener("end",s),e.removeListener("error",a),e.removeListener("close",i),e.removeListener("readable",o)}function i(c){te("onclose had error %o",c)}function s(){te("onend")}function a(c){D(),te("onerror %o",c),u(c)}function l(c){r.push(c),n+=c.length;const f=Buffer.concat(r,n);if(f.indexOf(`\r
\r
`)===-1){te("have not received end of HTTP headers yet..."),o();return}const d=f.toString("ascii",0,f.indexOf(`\r
`)),h=+d.split(" ")[1];te("got proxy server response: %o",d),t({statusCode:h,buffered:f})}e.on("error",a),e.on("close",i),e.on("end",s),o()})}ht.default=fi;var pi=b&&b.__awaiter||function(e,t,u,n){function r(o){return o instanceof u?o:new u(function(D){D(o)})}return new(u||(u=Promise))(function(o,D){function i(l){try{a(n.next(l))}catch(c){D(c)}}function s(l){try{a(n.throw(l))}catch(c){D(c)}}function a(l){l.done?o(l.value):r(l.value).then(i,s)}a((n=n.apply(e,t||[])).next())})},z=b&&b.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(pt,"__esModule",{value:!0});const Zu=z(Cn),Qu=z(gn),di=z(En),mi=z(St),hi=z(oe),Fi=ai,Ci=z(ht),ue=hi.default("https-proxy-agent:agent");class gi extends Fi.Agent{constructor(t){let u;if(typeof t=="string"?u=di.default.parse(t):u=t,!u)throw new Error("an HTTP(S) proxy server `host` and `port` must be specified!");ue("creating new HttpsProxyAgent instance: %o",u),super(u);const n=Object.assign({},u);this.secureProxy=u.secureProxy||bi(n.protocol),n.host=n.hostname||n.host,typeof n.port=="string"&&(n.port=parseInt(n.port,10)),!n.port&&n.host&&(n.port=this.secureProxy?443:80),this.secureProxy&&!("ALPNProtocols"in n)&&(n.ALPNProtocols=["http 1.1"]),n.host&&n.path&&(delete n.path,delete n.pathname),this.proxy=n}callback(t,u){return pi(this,void 0,void 0,function*(){const{proxy:n,secureProxy:r}=this;let o;r?(ue("Creating `tls.Socket`: %o",n),o=Qu.default.connect(n)):(ue("Creating `net.Socket`: %o",n),o=Zu.default.connect(n));const D=Object.assign({},n.headers);let s=`CONNECT ${`${u.host}:${u.port}`} HTTP/1.1\r
`;n.auth&&(D["Proxy-Authorization"]=`Basic ${Buffer.from(n.auth).toString("base64")}`);let{host:a,port:l,secureEndpoint:c}=u;yi(l,c)||(a+=`:${l}`),D.Host=a,D.Connection="close";for(const F of Object.keys(D))s+=`${F}: ${D[F]}\r
`;const f=Ci.default(o);o.write(`${s}\r
`);const{statusCode:p,buffered:d}=yield f;if(p===200){if(t.once("socket",Ei),u.secureEndpoint){ue("Upgrading socket connection to TLS");const F=u.servername||u.host;return Qu.default.connect(Object.assign(Object.assign({},wi(u,"host","hostname","path","port")),{socket:o,servername:F}))}return o}o.destroy();const h=new Zu.default.Socket({writable:!1});return h.readable=!0,t.once("socket",F=>{ue("replaying proxy buffer for failed request"),mi.default(F.listenerCount("data")>0),F.push(d),F.push(null)}),h})}}pt.default=gi;function Ei(e){e.resume()}function yi(e,t){return Boolean(!t&&e===80||t&&e===443)}function bi(e){return typeof e=="string"?/^https:?$/i.test(e):!1}function wi(e,...t){const u={};let n;for(n in e)t.includes(n)||(u[n]=e[n]);return u}var Bi=b&&b.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};const Ft=Bi(pt);function Ct(e){return new Ft.default(e)}(function(e){e.HttpsProxyAgent=Ft.default,e.prototype=Ft.default.prototype})(Ct||(Ct={}));var $i=Ct;const vi={"":"<commit message>, or if it fits with previous commits, then use the conventional style: <type>(<optional scope>): <commit message>",conventional:"<type>(<optional scope>): <commit message>"},Ai=e=>`The output response must be in format:
${vi[e]}`;function xi(){return an('git log --pretty="format:%s (%ar)" -n 5').toString().split(`
`).map(u=>`  ${u}`).filter(Boolean)}function Si(){return`Here are some recent commit messages. Use them as guideline but ONLY if they seem recent and relevant:
${xi().join(`
`)}`}const Oi={"":"",conventional:`Choose a type from the type-to-description JSON below that best describes the git diff:
${JSON.stringify({docs:"Documentation only changes",style:"Changes that do not affect the meaning of the code (white-space, formatting, missing semi-colons, etc)",refactor:"A code change that neither fixes a bug, nor adds a feature, nor changes what the code does",perf:"A code change that improves performance",test:"Adding missing tests or correcting existing tests",build:"Changes that affect the build system or external dependencies",ci:"Changes to our CI configuration files and scripts",chore:"Other changes that don't modify src or test files",revert:"Reverts a previous commit",feat:"A new feature or an improvement to the existing code",fix:"A bug fix"},null,2)}`};function Pi(e){return e?`The developer provided the following hint as part of their rationale or goal. This is important to consider! The hint is: "${e?.value}".`:""}const Ti=(e,t,u,n)=>["Generate a concise git commit message written in present tense for the following code diff with the given specifications below:",`Message language: ${e}`,`Commit message must be a maximum of ${t} characters.`,"Exclude anything unnecessary such as translation. Your entire response will be passed directly into git commit.",'Focus on the "why", not the "what". Whenever possible, try to infer the reasoning for the developer to make these changes.',Pi(n),Oi[u||"conventional"],Ai(u),Si()].filter(Boolean).join(`
`),Ii=oe("Prompt"),_i=async(e,t,u,n,r,o)=>new Promise((D,i)=>{const s=JSON.stringify(n),a=Fn.request({port:443,hostname:e,path:t,method:"POST",headers:{...u,"Content-Type":"application/json","Content-Length":Buffer.byteLength(s)},timeout:r,agent:o?$i(o):void 0},l=>{const c=[];l.on("data",f=>c.push(f)),l.on("end",()=>{D({request:a,response:l,data:Buffer.concat(c).toString()})})});a.on("error",i),a.on("timeout",()=>{a.destroy(),i(new A(`Time out error: request took over ${r}ms. Try increasing the \`timeout\` config, or checking the OpenAI API status https://status.openai.com`))}),a.write(s),a.end()}),ki=async(e,t,u,n)=>{cn("/tmp/aicommits_latest_prompt.txt",t.messages[0].content);const{response:r,data:o}=await _i("api.openai.com","/v1/chat/completions",{Authorization:`Bearer ${e}`},t,u,n);if(!r.statusCode||r.statusCode<200||r.statusCode>299){let D=`OpenAI API Error: ${r.statusCode} - ${r.statusMessage}`;throw o&&(D+=`

${o}`),r.statusCode===500&&(D+=`

Check the API status: https://status.openai.com`),new A(D)}return JSON.parse(o)},Ri=e=>e.trim().replace(/[\n\r]/g,"").replace(/(\w)\.$/,"$1"),ji=e=>Array.from(new Set(e)),en=async(e,t,u,n,r,o,D,i,s,a)=>{try{const l=Ti(u,o,D,s);Ii(`Using prompt: ${l}`);const c=await ki(e,{model:t,messages:[{role:"system",content:l},{role:"user",content:n}],temperature:.7,top_p:1,frequency_penalty:0,presence_penalty:0,max_tokens:200,stream:!1,n:r},i,a);return ji(c.choices.filter(f=>f.message?.content).map(f=>Ri(f.message.content)))}catch(l){const c=l;throw c.code==="ENOTFOUND"?new A(`Error connecting to ${c.hostname} (${c.syscall}). Are you connected to the internet?`):c}};var Mi=async(e,t,u,n,r,o)=>(async()=>{Lu(Pu(Ou(" aicommits "))),await Gu();const D=Dt();u&&await Z("git",["add","--update"]),D.start("Detecting staged files");const i=await Wu(t);if(!i)throw D.stop("Detecting staged files"),new A("No staged changes found. Stage your changes manually, or automatically stage all changes with the `--all` flag.");D.stop(`${ei(i.files)}:
${i.files.map(p=>`     ${p}`).join(`
`)}`);const{env:s}=process,a=await ft({OPENAI_KEY:s.OPENAI_KEY||s.OPENAI_API_KEY,proxy:s.https_proxy||s.HTTPS_PROXY||s.http_proxy||s.HTTP_PROXY,generate:e?.toString(),type:n?.toString()}),l=Dt();l.start("The AI is analyzing your changes");let c;try{c=await en(a.OPENAI_KEY,a.model,a.locale,i.diff,a.generate,a["max-length"],a.type,a.timeout,r,a.proxy)}finally{l.stop("Changes analyzed")}if(c.length===0)throw new A("No commit messages were generated. Try again.");let f;if(c.length===1){[f]=c;const p=await ZD({message:`Use this commit message?

   ${f}
`});if(!p||ku(p)){K("Commit cancelled");return}}else{const p=await QD({message:`Pick a commit message to use: ${Ze("(Ctrl+c to exit)")}`,options:c.map(d=>({label:d,value:d}))});if(ku(p)){K("Commit cancelled");return}f=p}await Z("git",["commit","-m",f,...o]),K(`${Fe("\u2714")} Successfully committed!`)})().catch(D=>{K(`${he("\u2716")} ${D.message}`),ge(D),process.exit(1)});const[gt,Ni]=process.argv.slice(2);var Li=()=>(async()=>{if(!gt)throw new A('Commit message file path is missing. This file should be called from the "prepare-commit-msg" git hook');if(Ni)return;const e=await Wu();if(!e)return;Lu(Pu(Ou(" aicommits ")));const{env:t}=process,u=await ft({proxy:t.https_proxy||t.HTTPS_PROXY||t.http_proxy||t.HTTP_PROXY}),n=Dt();n.start("The AI is analyzing your changes");let r;try{r=await en(u.OPENAI_KEY,u.model,u.locale,e.diff,u.generate,u["max-length"],u.type,u.timeout,void 0,u.proxy)}finally{n.stop("Changes analyzed")}const D=await x.readFile(gt,"utf8")!=="",i=r.length>1;let s="";D&&(s=`# \u{1F916} AI generated commit${i?"s":""}
`),i?(D&&(s+=`# Select one of the following messages by uncommeting:
`),s+=`
${r.map(a=>`# ${a}`).join(`
`)}`):(D&&(s+=`# Edit the message below and commit:
`),s+=`
${r[0]}
`),await x.appendFile(gt,s),K(`${Fe("\u2714")} Saved commit message!`)})().catch(e=>{K(`${he("\u2716")} ${e.message}`),ge(e),process.exit(1)}),Gi=Zt({name:"config",parameters:["<mode>","<key=value...>"]},e=>{(async()=>{const{mode:t,keyValue:u}=e._;if(t==="get"){const n=await ft({},!0);for(const r of u)Yu(n,r)&&console.log(`${r}=${n[r]}`);return}if(t==="set"){await ni(u.map(n=>n.split("=")));return}throw new A(`Invalid mode: ${t}`)})().catch(t=>{console.error(`${he("\u2716")} ${t.message}`),ge(t),process.exit(1)})});const tn="prepare-commit-msg",un=`.git/hooks/${tn}`,Be=yn(new URL("cli.mjs",import.meta.url)),Ui=process.argv[1].replace(/\\/g,"/").endsWith(`/${un}`),nn=process.platform==="win32",rn=`
#!/usr/bin/env node
import(${JSON.stringify(bn(Be))})
`.trim();var Wi=Zt({name:"hook",parameters:["<install/uninstall>"]},e=>{(async()=>{const t=await Gu(),{installUninstall:u}=e._,n=L.join(t,un),r=await Vu(n);if(u==="install"){if(r){if(await x.realpath(n).catch(()=>{})===Be){console.warn("The hook is already installed");return}throw new A(`A different ${tn} hook seems to be installed. Please remove it before installing aicommits.`)}await x.mkdir(L.dirname(n),{recursive:!0}),nn?await x.writeFile(n,rn):(await x.symlink(Be,n,"file"),await x.chmod(n,493)),console.log(`${Fe("\u2714")} Hook installed`);return}if(u==="uninstall"){if(!r){console.warn("Hook is not installed");return}if(nn){if(await x.readFile(n,"utf8")!==rn){console.warn("Hook is not installed");return}}else if(await x.realpath(n)!==Be){console.warn("Hook is not installed");return}await x.rm(n),console.log(`${Fe("\u2714")} Hook uninstalled`);return}throw new A(`Invalid mode: ${u}`)})().catch(t=>{console.error(`${he("\u2716")} ${t.message}`),ge(t),process.exit(1)})});const on=process.argv.slice(2);Gr({name:"aicommits",version:Qt,flags:{generate:{type:Number,description:"Number of messages to generate (Warning: generating multiple costs more) (default: 1)",alias:"g"},exclude:{type:[String],description:"Files to exclude from AI analysis",alias:"x"},all:{type:Boolean,description:"Automatically stage changes in tracked files for the commit",alias:"a",default:!1},type:{type:String,description:"Type of commit message to generate",alias:"t"},hint:{type:String,description:"A hint to help the AI generate a commit message",alias:"i"}},commands:[Gi,Wi],help:{description:Ur},ignoreArgv:e=>e==="unknown-flag"||e==="argument"},e=>{Ui?Li():Mi(e.flags.generate,e.flags.exclude,e.flags.all,e.flags.type,e.flags.hint?{value:e.flags.hint}:void 0,on)},on);
